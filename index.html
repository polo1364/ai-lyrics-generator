<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ê≠åË©ûÁîüÊàêÂô® Pro | Suno Â∞àÁî®</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: rgba(20, 20, 30, 0.8);
            --bg-input: rgba(30, 30, 45, 0.6);
            --border-color: rgba(255, 255, 255, 0.08);
            --border-glow: rgba(0, 212, 255, 0.3);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.85);
            --text-muted: rgba(255, 255, 255, 0.55);
            --accent-cyan: #00d4ff;
            --accent-magenta: #ff00aa;
            --accent-purple: #8b5cf6;
            --accent-orange: #ff6b35;
            --accent-green: #00ff88;
            --accent-yellow: #fbbf24;
            --gradient-main: linear-gradient(135deg, #00d4ff 0%, #8b5cf6 50%, #ff00aa 100%);
            --gradient-button: linear-gradient(135deg, #00d4ff 0%, #8b5cf6 100%);
            --gradient-warm: linear-gradient(135deg, #ff6b35 0%, #ff00aa 100%);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.1);
            --shadow-glow: 0 0 40px rgba(0, 212, 255, 0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .bg-gradient {
            position: fixed;
            inset: 0;
            z-index: -1;
            overflow: hidden;
        }

        .bg-gradient::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(ellipse 80% 50% at 20% 20%, rgba(0, 212, 255, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 80% 80%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse 50% 60% at 50% 50%, rgba(255, 0, 170, 0.08) 0%, transparent 50%);
            animation: bgFloat 20s ease-in-out infinite;
        }

        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(2%, 2%) rotate(1deg); }
            66% { transform: translate(-1%, 1%) rotate(-1deg); }
        }

        .grid-overlay {
            position: fixed;
            inset: 0;
            z-index: -1;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 50px 50px;
            mask-image: radial-gradient(ellipse 80% 60% at 50% 30%, black, transparent);
        }

        .app-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-icon {
            width: 70px;
            height: 70px;
            background: var(--gradient-main);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            box-shadow: 0 10px 40px rgba(0, 212, 255, 0.3);
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .logo-text { 
            text-align: left;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .logo-title-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
            line-height: 1.2;
        }

        .logo-subtitle {
            font-size: 0.85em;
            color: var(--text-secondary);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .pro-badge {
            background: var(--gradient-warm);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.5em;
            font-weight: 700;
            letter-spacing: 1px;
            font-family: 'Orbitron', sans-serif;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.4);
            flex-shrink: 0;
        }

        .header-description {
            color: var(--text-secondary);
            font-size: 1em;
            max-width: 550px;
            margin: 0 auto;
        }

        /* Âç°ÁâáËàáÂçÄÂ°ä */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 30px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.5), transparent);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .card:hover::before { opacity: 1; }
        .card:hover {
            border-color: var(--border-glow);
            box-shadow: var(--shadow-glow);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-icon {
            width: 42px;
            height: 42px;
            background: var(--gradient-button);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .card-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* ÂèØÊäòÁñäÂçÄÂ°ä */
        .collapsible-section {
            margin-bottom: 20px;
        }

        .section-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(0, 212, 255, 0.08);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s;
        }

        .section-toggle:hover {
            background: rgba(0, 212, 255, 0.12);
        }

        .section-toggle-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-toggle-icon {
            font-size: 1.3em;
        }

        .section-toggle-title {
            font-weight: 600;
            font-size: 1em;
            color: var(--text-primary);
        }

        .section-toggle-hint {
            font-size: 0.85em;
            color: var(--text-muted);
            margin-left: 10px;
        }

        .section-toggle-arrow {
            font-size: 1.2em;
            transition: transform 0.3s;
            color: var(--accent-cyan);
        }

        .section-toggle.open .section-toggle-arrow {
            transform: rotate(180deg);
        }

        .section-content {
            display: none;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            animation: slideDown 0.3s ease-out;
        }

        .section-content.open {
            display: block;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ë°®ÂñÆÊ®£Âºè */
        .form-group { margin-bottom: 20px; }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-weight: 500;
            font-size: 0.95em;
            color: var(--text-primary);
        }

        .label-hint {
            font-size: 0.8em;
            color: var(--text-muted);
            font-weight: 400;
        }

        .selection-count {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 2px 10px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: auto;
        }

        input[type="text"],
        input[type="password"],
        select,
        textarea {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.95em;
            font-family: inherit;
            transition: all 0.3s;
            outline: none;
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-muted);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.15);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d4ff' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 45px;
        }

        select option {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .form-row-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        @media (max-width: 900px) {
            .form-row-4 { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 640px) {
            .form-row, .form-row-3, .form-row-4 { grid-template-columns: 1fr; }
        }

        /* ÂñÆÈÅ∏ÊåâÈàïÁµÑ */
        .radio-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .radio-option {
            position: relative;
            cursor: pointer;
            flex: 1;
            min-width: 140px;
        }

        .radio-option input {
            position: absolute;
            opacity: 0;
        }

        .radio-option .radio-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            transition: all 0.3s;
            font-size: 0.9em;
            text-align: center;
            color: var(--text-secondary);
        }

        .radio-option input:checked + .radio-label {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
            border-color: var(--accent-cyan);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.2);
            color: var(--text-primary);
        }

        .radio-option:hover .radio-label {
            border-color: rgba(0, 212, 255, 0.5);
        }

        /* Â§öÈÅ∏‰∏ãÊãâÈÅ∏ÂñÆ */
        .multi-select-container { position: relative; }

        .multi-select-display {
            width: 100%;
            min-height: 52px;
            padding: 10px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .multi-select-display:hover {
            border-color: rgba(0, 212, 255, 0.5);
        }

        .multi-select-display.active {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.15);
        }

        .selected-items {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        .selected-tag {
            background: var(--gradient-button);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            animation: tagPop 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes tagPop {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .selected-tag .remove-tag {
            cursor: pointer;
            font-size: 1.1em;
            line-height: 1;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .selected-tag .remove-tag:hover { opacity: 1; }

        .multi-select-placeholder {
            color: var(--text-muted);
        }

        .multi-select-arrow {
            color: var(--accent-cyan);
            font-size: 0.8em;
            transition: transform 0.3s;
        }

        .multi-select-arrow.open {
            transform: rotate(180deg);
        }

        .multi-select-dropdown {
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-glow);
            border-radius: var(--radius-md);
            max-height: 350px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .multi-select-dropdown.show { display: block; }

        .dropdown-group {
            border-bottom: 1px solid var(--border-color);
        }

        .dropdown-group:last-child { border-bottom: none; }

        .dropdown-group-label {
            padding: 10px 15px;
            font-weight: 600;
            font-size: 0.85em;
            color: var(--accent-cyan);
            background: rgba(0, 212, 255, 0.05);
        }

        .dropdown-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .dropdown-option:hover { background: rgba(0, 212, 255, 0.1); }
        .dropdown-option.selected { background: rgba(0, 212, 255, 0.15); }

        .dropdown-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-cyan);
        }

        .dropdown-option label {
            flex: 1;
            cursor: pointer;
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .dropdown-actions {
            padding: 10px 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
        }

        .dropdown-actions button {
            flex: 1;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        .dropdown-actions button:hover {
            background: rgba(0, 212, 255, 0.2);
            color: var(--text-primary);
        }

        /* ÊåâÈàï */
        .btn {
            padding: 14px 28px;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--gradient-button);
            color: white;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent-cyan);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
            display: none;
        }

        .loading.show { display: block; }

        .spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(0, 212, 255, 0.1);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .loading-text {
            color: var(--text-secondary);
            font-size: 1em;
        }

        /* ÁµêÊûúÂçÄÂüü */
        .result-section {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        .result-section.show { display: block; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Â∞àËºØË≥áË®äÂçÄÂ°ä */
        .album-info {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(255, 0, 170, 0.1) 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
        }

        .album-name {
            font-size: 1.8em;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .album-meta {
            color: var(--text-muted);
            font-size: 0.9em;
        }

        /* Ê≠åÊõ≤ÂàóË°® */
        .track-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .track-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: all 0.3s;
        }

        .track-item:hover {
            border-color: var(--border-glow);
        }

        .track-item.active {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
        }

        .track-header {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .track-header:hover {
            background: rgba(0, 212, 255, 0.05);
        }

        .track-number {
            width: 36px;
            height: 36px;
            background: var(--gradient-button);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9em;
            flex-shrink: 0;
        }

        .track-info {
            flex: 1;
            min-width: 0;
        }

        .track-title {
            font-weight: 600;
            font-size: 1.05em;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-style {
            font-size: 0.8em;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-toggle {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .track-item.active .track-toggle {
            background: var(--accent-cyan);
            transform: rotate(180deg);
        }

        .track-content {
            display: none;
            padding: 0 20px 20px;
            animation: slideDown 0.3s ease-out;
        }

        .track-item.active .track-content {
            display: block;
        }

        /* ÂñÆÊõ≤ÁâàÊú¨Ê®ôÁ±§ */
        .version-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .version-tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.9em;
            color: var(--text-secondary);
            transition: all 0.3s;
        }

        .version-tab:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: rgba(0, 212, 255, 0.3);
        }

        .version-tab.active {
            background: var(--gradient-button);
            color: white;
            border-color: transparent;
        }

        .version-content {
            display: none;
        }

        .version-content.active {
            display: block;
        }

        /* È¢®Ê†ºÊèêÁ§∫Ë©ûÂçÄÂ°ä */
        .style-prompt-section {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.08) 0%, rgba(139, 92, 246, 0.08) 100%);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
        }

        .style-prompt-header {
            font-weight: 600;
            font-size: 0.95em;
            color: var(--accent-cyan);
            margin-bottom: 12px;
        }

        .style-prompt-output {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            color: var(--text-secondary);
            line-height: 1.6;
            word-break: break-word;
        }

        .copy-style-prompt-btn {
            margin-top: 12px;
            padding: 8px 16px;
            background: rgba(0, 212, 255, 0.15);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: var(--radius-sm);
            color: var(--accent-cyan);
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-style-prompt-btn:hover {
            background: rgba(0, 212, 255, 0.25);
        }

        /* Ê≠åË©ûÈ°ØÁ§∫ */
        .lyrics-output {
            background: rgba(0, 0, 0, 0.4);
            border-radius: var(--radius-md);
            padding: 25px;
            font-family: 'Noto Sans TC', sans-serif;
            font-size: 0.95em;
            line-height: 1.9;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-break: break-word;
            max-height: 500px;
            overflow-y: auto;
        }

        .lyrics-output::-webkit-scrollbar {
            width: 8px;
        }

        .lyrics-output::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .lyrics-output::-webkit-scrollbar-thumb {
            background: rgba(0, 212, 255, 0.3);
            border-radius: 4px;
        }

        /* Êìç‰ΩúÊåâÈàï */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .action-btn {
            flex: 1;
            min-width: 100px;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            font-size: 0.85em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-cyan);
            color: var(--text-primary);
        }

        .action-btn.copy-btn:hover { border-color: var(--accent-green); }
        .action-btn.suno-btn:hover { border-color: var(--accent-magenta); }
        .action-btn.export-btn:hover { border-color: var(--accent-yellow); }
        .action-btn.add-lib-btn:hover { border-color: var(--accent-purple); }

        /* Ë©ûÂ∫´ÂçÄÂüü */
        .library-section {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 25px;
            margin-top: 30px;
        }

        .library-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .library-title {
            font-size: 1.2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .library-count {
            background: var(--accent-purple);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7em;
        }

        .global-actions {
            display: flex;
            gap: 10px;
        }

        .global-actions button {
            padding: 10px 18px;
            border-radius: var(--radius-md);
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
        }

        .global-actions button:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: var(--accent-cyan);
        }

        .library-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .library-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 18px;
            transition: all 0.3s;
        }

        .library-item:hover {
            border-color: var(--border-glow);
        }

        .lib-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .lib-item-header span:first-child {
            font-weight: 600;
            color: var(--text-primary);
        }

        .lib-item-date {
            font-size: 0.8em;
            color: var(--text-muted);
        }

        .lib-preview {
            font-size: 0.85em;
            color: var(--text-muted);
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .lib-actions {
            display: flex;
            gap: 10px;
        }

        .lib-actions button {
            flex: 1;
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.8em;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .btn-load {
            background: rgba(0, 212, 255, 0.2);
            color: var(--accent-cyan);
        }

        .btn-load:hover {
            background: rgba(0, 212, 255, 0.3);
        }

        .btn-delete {
            background: rgba(255, 107, 53, 0.2);
            color: var(--accent-orange);
        }

        .btn-delete:hover {
            background: rgba(255, 107, 53, 0.3);
        }

        /* ÊèêÁ§∫Âç°Áâá */
        .tips-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.08) 0%, rgba(0, 212, 255, 0.08) 100%);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: var(--radius-xl);
            padding: 25px;
            margin-top: 30px;
        }

        .tips-header {
            font-weight: 600;
            font-size: 1.1em;
            color: var(--accent-green);
            margin-bottom: 15px;
        }

        .tips-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .tips-list li {
            position: relative;
            padding-left: 25px;
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .tips-list li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--accent-green);
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-size: 0.85em;
        }

        /* Ë®≠ÂÆöÊåâÈàï */
        .settings-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--gradient-button);
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }

        .settings-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(0, 212, 255, 0.5);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.show { display: flex; }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            max-width: 450px;
            width: 100%;
            padding: 30px;
            animation: modalIn 0.3s ease-out;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95) translateY(-20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-header h2 {
            font-size: 1.4em;
            margin-bottom: 8px;
        }

        .modal-header p {
            color: var(--text-muted);
            font-size: 0.9em;
        }

        .info-box {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.85em;
        }

        .info-box a {
            color: var(--accent-cyan);
        }

        .modal-body { margin-bottom: 25px; }

        .modal-footer {
            display: flex;
            gap: 12px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border-radius: var(--radius-md);
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .modal-btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .modal-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .modal-btn-primary {
            background: var(--gradient-button);
            color: white;
        }

        .modal-btn-primary:hover {
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.4);
        }

        /* ÁîüÊàêÊ®°ÂºèÈÅ∏Êìá */
        .mode-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .mode-option {
            flex: 1;
            position: relative;
            cursor: pointer;
        }

        .mode-option input {
            position: absolute;
            opacity: 0;
        }

        .mode-card {
            padding: 20px;
            background: var(--bg-input);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            text-align: center;
            transition: all 0.3s;
        }

        .mode-option input:checked + .mode-card {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
            border-color: var(--accent-cyan);
            box-shadow: 0 0 25px rgba(0, 212, 255, 0.2);
        }

        .mode-option:hover .mode-card {
            border-color: rgba(0, 212, 255, 0.5);
        }

        .mode-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .mode-title {
            font-weight: 600;
            font-size: 1.1em;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .mode-desc {
            font-size: 0.8em;
            color: var(--text-muted);
        }

        /* Â∞àËºØÊ≠åÊõ≤Êï∏ÈáèÊªëÊ°ø */
        .album-count-section {
            display: none;
            padding: 20px;
            background: rgba(139, 92, 246, 0.08);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: var(--radius-md);
            margin-bottom: 20px;
        }

        .album-count-section.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        .album-count-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .album-count-label {
            font-weight: 600;
            color: var(--text-primary);
        }

        .album-count-value {
            background: var(--accent-purple);
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1em;
        }

        .album-count-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            outline: none;
        }

        .album-count-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--gradient-main);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 212, 255, 0.4);
            transition: transform 0.2s;
        }

        .album-count-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        .album-count-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--gradient-main);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.8em;
            color: var(--text-muted);
        }

        @media (max-width: 640px) {
            .mode-selector {
                flex-direction: column;
            }
            
            .logo-title { font-size: 1.6em; }
            .logo-icon { width: 55px; height: 55px; font-size: 28px; }
            .app-container { padding: 20px 15px; }
            .card { padding: 20px; }
            .settings-btn { bottom: 20px; right: 20px; width: 50px; height: 50px; font-size: 20px; }
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>
    <div class="grid-overlay"></div>

    <div class="app-container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üéµ</div>
                <div class="logo-text">
                    <div class="logo-title-wrapper">
                        <span class="logo-title">LYRICS AI</span>
                        <span class="pro-badge">PRO</span>
                    </div>
                    <span class="logo-subtitle">Suno Ê≠åË©ûÁîüÊàêÂô®</span>
                </div>
            </div>
            <p class="header-description">ÈÅãÁî® AI Âø´ÈÄüÁîüÊàêÂ∞àÊ•≠Ê≠åË©ûËàáÈ¢®Ê†ºÊèêÁ§∫Ë©ûÔºåÊîØÊè¥ÂñÆÊõ≤ËàáÂ∞àËºØÊ®°Âºè</p>
        </header>

        <!-- ‰∏ªÈ°åËº∏ÂÖ• -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üí°</div>
                <h2 class="card-title">Ââµ‰Ωú‰∏ªÈ°å</h2>
            </div>

            <div class="form-group">
                <label class="form-label">üé§ Ê≠åÊõ≤È°ûÂûã</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="songType" value="vocal" checked>
                        <span class="radio-label">üéôÔ∏è ‰∫∫ËÅ≤Ê≠åÊõ≤</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="songType" value="instrumental">
                        <span class="radio-label">üéπ Á¥îÈü≥Ê®Ç</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">‚ú® ‰∏ªÈ°å/ÈùàÊÑü</label>
                <input type="text" id="theme" placeholder="‰æãÂ¶Ç:Â§èÊó•Êµ∑ÈÇäÁöÑÈÇÇÈÄÖ„ÄÅÂ§±ÊàÄÁöÑÊ∑±Â§úÁç®ÁôΩ„ÄÅËøΩÂ§¢ÁöÑÈùíÊò•...">
            </div>
        </div>

        <!-- ÈÄ≤ÈöéË®≠ÂÆö -->
        <div class="collapsible-section">
            <button class="section-toggle" onclick="toggleSection('advanced')">
                <div class="section-toggle-left">
                    <span class="section-toggle-icon">üéõÔ∏è</span>
                    <span class="section-toggle-title">ÈÄ≤ÈöéÈü≥Ê®ÇË®≠ÂÆö</span>
                    <span class="section-toggle-hint">ÂèØÈÅ∏</span>
                </div>
                <span class="section-toggle-arrow" id="advancedArrowIcon">‚ñº</span>
            </button>
            <div class="section-content" id="advancedSection">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">üé∏ Èü≥Ê®ÇÈ¢®Ê†º <span class="selection-count" id="genreCount"></span></label>
                        <div class="multi-select-container" id="genreContainer">
                            <div class="multi-select-display" onclick="toggleDropdown('genre')">
                                <div class="selected-items" id="genreSelected">
                                    <span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>
                                </div>
                                <span class="multi-select-arrow" id="genreArrow">‚ñº</span>
                            </div>
                            <div class="multi-select-dropdown" id="genreDropdown">
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé§ ÊµÅË°å/‰∏ªÊµÅ</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Pop" value="Pop" onchange="updateMultiSelect('genre')"><label for="g_Pop">Pop ÊµÅË°å</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_KPop" value="K-Pop" onchange="updateMultiSelect('genre')"><label for="g_KPop">K-Pop ÈüìÊµÅ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_JPop" value="J-Pop" onchange="updateMultiSelect('genre')"><label for="g_JPop">J-Pop Êó•ÊµÅ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_CPop" value="C-Pop" onchange="updateMultiSelect('genre')"><label for="g_CPop">C-Pop ËèØË™ûÊµÅË°å</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Dance" value="Dance Pop" onchange="updateMultiSelect('genre')"><label for="g_Dance">Dance Pop ËàûÊõ≤</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Ballad" value="Ballad" onchange="updateMultiSelect('genre')"><label for="g_Ballad">Ballad ÊäíÊÉÖ</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé∏ ÊêñÊªæ/ÈáëÂ±¨</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Rock" value="Rock" onchange="updateMultiSelect('genre')"><label for="g_Rock">Rock ÊêñÊªæ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_AltRock" value="Alternative Rock" onchange="updateMultiSelect('genre')"><label for="g_AltRock">Alternative Âè¶È°ûÊêñÊªæ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Indie" value="Indie Rock" onchange="updateMultiSelect('genre')"><label for="g_Indie">Indie Áç®Á´ãÊêñÊªæ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Metal" value="Metal" onchange="updateMultiSelect('genre')"><label for="g_Metal">Metal ÈáëÂ±¨</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Punk" value="Punk" onchange="updateMultiSelect('genre')"><label for="g_Punk">Punk ÈæêÂÖã</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üéπ ÈõªÂ≠ê/EDM</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_EDM" value="EDM" onchange="updateMultiSelect('genre')"><label for="g_EDM">EDM ÈõªÂ≠êËàûÊõ≤</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_House" value="House" onchange="updateMultiSelect('genre')"><label for="g_House">House Êµ©ÂÆ§</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Techno" value="Techno" onchange="updateMultiSelect('genre')"><label for="g_Techno">Techno ÈêµÂÖãË´æ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Trance" value="Trance" onchange="updateMultiSelect('genre')"><label for="g_Trance">Trance Âá∫Á•û</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Dubstep" value="Dubstep" onchange="updateMultiSelect('genre')"><label for="g_Dubstep">Dubstep</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Synthwave" value="Synthwave" onchange="updateMultiSelect('genre')"><label for="g_Synthwave">Synthwave ÂêàÊàêÂô®Êµ™ÊΩÆ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_LoFi" value="Lo-Fi" onchange="updateMultiSelect('genre')"><label for="g_LoFi">Lo-Fi</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé§ ÂòªÂìà/R&B</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_HipHop" value="Hip Hop" onchange="updateMultiSelect('genre')"><label for="g_HipHop">Hip Hop ÂòªÂìà</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Trap" value="Trap" onchange="updateMultiSelect('genre')"><label for="g_Trap">Trap</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_RnB" value="R&B" onchange="updateMultiSelect('genre')"><label for="g_RnB">R&B ÁØÄÂ•èËóçË™ø</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Soul" value="Soul" onchange="updateMultiSelect('genre')"><label for="g_Soul">Soul ÈùàÈ≠ÇÊ®Ç</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé∑ ÁàµÂ£´/ËóçË™ø</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Jazz" value="Jazz" onchange="updateMultiSelect('genre')"><label for="g_Jazz">Jazz ÁàµÂ£´</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Blues" value="Blues" onchange="updateMultiSelect('genre')"><label for="g_Blues">Blues ËóçË™ø</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Bossa" value="Bossa Nova" onchange="updateMultiSelect('genre')"><label for="g_Bossa">Bossa Nova Â∑¥Ëñ©Ë´æÁì¶</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üåç ‰∏ñÁïå/Ê∞ëÊóè</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Folk" value="Folk" onchange="updateMultiSelect('genre')"><label for="g_Folk">Folk Ê∞ëË¨†</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Country" value="Country" onchange="updateMultiSelect('genre')"><label for="g_Country">Country ÈÑâÊùë</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Reggae" value="Reggae" onchange="updateMultiSelect('genre')"><label for="g_Reggae">Reggae Èõ∑È¨º</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Latin" value="Latin" onchange="updateMultiSelect('genre')"><label for="g_Latin">Latin Êãâ‰∏Å</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Chinese" value="Chinese Traditional" onchange="updateMultiSelect('genre')"><label for="g_Chinese">Chinese ‰∏≠ÂúãÈ¢®</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üéª Âè§ÂÖ∏/ÈÖçÊ®Ç</div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Classical" value="Classical" onchange="updateMultiSelect('genre')"><label for="g_Classical">Classical Âè§ÂÖ∏</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Orchestra" value="Orchestral" onchange="updateMultiSelect('genre')"><label for="g_Orchestra">Orchestral ÁÆ°Âº¶Ê®Ç</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Cinematic" value="Cinematic" onchange="updateMultiSelect('genre')"><label for="g_Cinematic">Cinematic ÈõªÂΩ±ÈÖçÊ®Ç</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="g_Ambient" value="Ambient" onchange="updateMultiSelect('genre')"><label for="g_Ambient">Ambient Ê∞õÂúç</label></div>
                                </div>
                                <div class="dropdown-actions">
                                    <button type="button" onclick="clearAll('genre')">Ê∏ÖÈô§ÂÖ®ÈÉ®</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üí´ ÊÉÖÊÑüÊ∞õÂúç <span class="selection-count" id="moodCount"></span></label>
                        <div class="multi-select-container" id="moodContainer">
                            <div class="multi-select-display" onclick="toggleDropdown('mood')">
                                <div class="selected-items" id="moodSelected">
                                    <span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>
                                </div>
                                <span class="multi-select-arrow" id="moodArrow">‚ñº</span>
                            </div>
                            <div class="multi-select-dropdown" id="moodDropdown">
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üòä Ê≠£ÂêëÊÉÖÊÑü</div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Happy" value="Happy" onchange="updateMultiSelect('mood')"><label for="m_Happy">Happy Ê≠°Ê®Ç</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Uplifting" value="Uplifting" onchange="updateMultiSelect('mood')"><label for="m_Uplifting">Uplifting ÊåØÂ•Æ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Romantic" value="Romantic" onchange="updateMultiSelect('mood')"><label for="m_Romantic">Romantic Êµ™Êº´</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Hopeful" value="Hopeful" onchange="updateMultiSelect('mood')"><label for="m_Hopeful">Hopeful Â∏åÊúõ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Playful" value="Playful" onchange="updateMultiSelect('mood')"><label for="m_Playful">Playful ‰øèÁöÆ</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üò¢ ÊÜÇÈ¨±ÊÉÖÊÑü</div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Sad" value="Sad" onchange="updateMultiSelect('mood')"><label for="m_Sad">Sad ÊÇ≤ÂÇ∑</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Melancholic" value="Melancholic" onchange="updateMultiSelect('mood')"><label for="m_Melancholic">Melancholic ÊÜÇÈ¨±</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Nostalgic" value="Nostalgic" onchange="updateMultiSelect('mood')"><label for="m_Nostalgic">Nostalgic Êá∑Ëàä</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Bittersweet" value="Bittersweet" onchange="updateMultiSelect('mood')"><label for="m_Bittersweet">Bittersweet Ëã¶Áîú</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">‚ö° Âº∑ÁÉàÊÉÖÊÑü</div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Energetic" value="Energetic" onchange="updateMultiSelect('mood')"><label for="m_Energetic">Energetic Ê¥ªÂäõ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Aggressive" value="Aggressive" onchange="updateMultiSelect('mood')"><label for="m_Aggressive">Aggressive ÊøÄÈÄ≤</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Passionate" value="Passionate" onchange="updateMultiSelect('mood')"><label for="m_Passionate">Passionate ÁÜ±ÊÉÖ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Intense" value="Intense" onchange="updateMultiSelect('mood')"><label for="m_Intense">Intense Âº∑ÁÉà</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Dark" value="Dark" onchange="updateMultiSelect('mood')"><label for="m_Dark">Dark ÈªëÊöó</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üßò Âπ≥ÈùúÊÉÖÊÑü</div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Calm" value="Calm" onchange="updateMultiSelect('mood')"><label for="m_Calm">Calm Âπ≥Èùú</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Dreamy" value="Dreamy" onchange="updateMultiSelect('mood')"><label for="m_Dreamy">Dreamy Â§¢Âπª</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Peaceful" value="Peaceful" onchange="updateMultiSelect('mood')"><label for="m_Peaceful">Peaceful ÂíåÂπ≥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="m_Ethereal" value="Ethereal" onchange="updateMultiSelect('mood')"><label for="m_Ethereal">Ethereal Á©∫Èùà</label></div>
                                </div>
                                <div class="dropdown-actions">
                                    <button type="button" onclick="clearAll('mood')">Ê∏ÖÈô§ÂÖ®ÈÉ®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row-4">
                    <div class="form-group">
                        <label class="form-label">ü•Å ÁØÄÂ•èÈÄüÂ∫¶</label>
                        <select id="bpm">
                            <option value="">Ëá™Âãï</option>
                            <option value="Slow tempo, 60-80 BPM">ÊÖ¢Êùø 60-80</option>
                            <option value="Medium tempo, 80-100 BPM">‰∏≠ÊÖ¢ 80-100</option>
                            <option value="Medium tempo, 100-120 BPM">‰∏≠Êùø 100-120</option>
                            <option value="Fast tempo, 120-140 BPM">Âø´Êùø 120-140</option>
                            <option value="Very fast, 140-170 BPM">Ê•µÂø´ 140-170</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üìÖ Âπ¥‰ª£È¢®Ê†º</label>
                        <select id="era">
                            <option value="">Ëá™Âãï</option>
                            <option value="60s style">60Âπ¥‰ª£</option>
                            <option value="70s style">70Âπ¥‰ª£</option>
                            <option value="80s style">80Âπ¥‰ª£</option>
                            <option value="90s style">90Âπ¥‰ª£</option>
                            <option value="2000s style">2000Âπ¥‰ª£</option>
                            <option value="2010s style">2010Âπ¥‰ª£</option>
                            <option value="Modern, 2020s">Áèæ‰ª£</option>
                            <option value="Futuristic">Êú™‰æÜÊÑü</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üéµ Ë™øÊÄß</label>
                        <select id="key">
                            <option value="">Ëá™Âãï</option>
                            <option value="Major key">Â§ßË™ø</option>
                            <option value="Minor key">Â∞èË™ø</option>
                            <option value="C Major">CÂ§ßË™ø</option>
                            <option value="G Major">GÂ§ßË™ø</option>
                            <option value="A Minor">AÂ∞èË™ø</option>
                            <option value="E Minor">EÂ∞èË™ø</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üåç Âú∞ÂüüÈ¢®Ê†º</label>
                        <select id="region">
                            <option value="">ÁÑ°</option>
                            <option value="Asian influence">‰∫ûÊ¥≤È¢®</option>
                            <option value="Western style">Ë•øÊ¥ãÈ¢®</option>
                            <option value="Latin influence">Êãâ‰∏ÅÈ¢®</option>
                            <option value="African rhythm">ÈùûÊ¥≤ÁØÄÂ•è</option>
                            <option value="Middle Eastern">‰∏≠Êù±È¢®</option>
                            <option value="Celtic">Âá±ÁàæÁâπ</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">üéöÔ∏è Ë£Ω‰ΩúË≥™ÊÑü</label>
                        <select id="production">
                            <option value="">Ëá™Âãï</option>
                            <option value="Raw, live recording">ÂéüÂßãÁèæÂ†¥</option>
                            <option value="Clean, studio quality">‰πæÊ∑®ÈåÑÈü≥ÂÆ§</option>
                            <option value="Lo-fi, vintage">‰Ωé‰øùÁúüÂæ©Âè§</option>
                            <option value="Polished, radio-ready">Á≤æÁ∑ªÂïÜÊ•≠</option>
                            <option value="Experimental, avant-garde">ÂØ¶È©óÂâçË°õ</option>
                            <option value="Acoustic, unplugged">‰∏çÊèíÈõªÂéüËÅ≤</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üîß ÁâπÊÆäÊäÄÊ≥ï</label>
                        <select id="technique">
                            <option value="">ÁÑ°</option>
                            <option value="with key change">ËΩâË™ø</option>
                            <option value="with tempo change">ËÆäÈÄü</option>
                            <option value="with breakdown">Â¥©ÊΩ∞ÊÆµËêΩ</option>
                            <option value="with drop">ÈáçÊãçËêΩÈªû</option>
                            <option value="with acapella section">Ê∏ÖÂî±ÊÆµËêΩ</option>
                            <option value="with spoken word">Âè£ÁôΩÊÆµËêΩ</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‰∫∫ËÅ≤Ë®≠ÂÆö -->
        <div class="collapsible-section">
            <button class="section-toggle" onclick="toggleSection('vocal')">
                <div class="section-toggle-left">
                    <span class="section-toggle-icon">üé§</span>
                    <span class="section-toggle-title">‰∫∫ËÅ≤ËàáÊ≠åË©ûË®≠ÂÆö</span>
                    <span class="section-toggle-hint">ÂèØÈÅ∏</span>
                </div>
                <span class="section-toggle-arrow" id="vocalArrowIcon">‚ñº</span>
            </button>
            <div class="section-content" id="vocalSection">
                <div class="form-row-3">
                    <div class="form-group">
                        <label class="form-label">üë§ ‰∫∫ËÅ≤È°ûÂûã</label>
                        <select id="voice">
                            <option value="Male vocal">Áî∑ËÅ≤</option>
                            <option value="Female vocal">Â•≥ËÅ≤</option>
                            <option value="Duet, male and female">Áî∑Â•≥Â∞çÂî±</option>
                            <option value="Choir">ÂêàÂî±Âúò</option>
                            <option value="Child vocal">Á´•ËÅ≤</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üåê Ê≠åË©ûË™ûË®Ä</label>
                        <select id="language">
                            <option value="ÁπÅÈ´î‰∏≠Êñá">ÁπÅÈ´î‰∏≠Êñá</option>
                            <option value="Á∞°È´î‰∏≠Êñá">Á∞°È´î‰∏≠Êñá</option>
                            <option value="Ëã±Êñá">Ëã±Êñá</option>
                            <option value="Êó•Êñá">Êó•Êñá</option>
                            <option value="ÈüìÊñá">ÈüìÊñá</option>
                            <option value="‰∏≠Ëã±Ê∑∑Âêà">‰∏≠Ëã±Ê∑∑Âêà</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üéôÔ∏è ‰∫∫ËÅ≤ÊïàÊûú</label>
                        <select id="vocalEffect">
                            <option value="">Ëá™ÁÑ∂</option>
                            <option value="Reverb vocal">ÊÆòÈüø</option>
                            <option value="Auto-tune vocal">Ëá™ÂãïË™øÈü≥</option>
                            <option value="Whisper vocal">ËÄ≥Ë™û</option>
                            <option value="Raspy vocal">Ê≤ôÂïû</option>
                            <option value="Falsetto">ÂÅáËÅ≤</option>
                            <option value="Belting">È´òÈü≥ÂÖ±È≥¥</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">üìú Ê≠åÊõ≤ÁµêÊßã</label>
                        <select id="structure">
                            <option value="Ê®ôÊ∫ñ (Verse-Chorus-Verse-Chorus-Bridge-Chorus)">Ê®ôÊ∫ñÊµÅË°å</option>
                            <option value="Á∞°ÂñÆ (Verse-Chorus-Verse-Chorus)">Á∞°ÂñÆÈáçË§á</option>
                            <option value="Êº∏ÈÄ≤ (Verse-Verse-Chorus-Verse-Chorus-Chorus)">Êº∏ÈÄ≤ÁôºÂ±ï</option>
                            <option value="Âè≤Ë©© (Intro-Verse-Chorus-Verse-Chorus-Bridge-Solo-Chorus-Outro)">Âè≤Ë©©Èï∑ÁØá</option>
                            <option value="Ëá™Áî± (ÁÑ°Âõ∫ÂÆöÁµêÊßã)">Ëá™Áî±ÂΩ¢Âºè</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">‚úçÔ∏è Ê≠åË©ûÈ¢®Ê†º</label>
                        <select id="lyricStyle">
                            <option value="">Ëá™Âãï</option>
                            <option value="Áõ¥ÁôΩÊïò‰∫ã">Áõ¥ÁôΩÊïò‰∫ã</option>
                            <option value="ÊÑèË±°Ë©©ÊÑè">ÊÑèË±°Ë©©ÊÑè</option>
                            <option value="Â∞çË©±Âºè">Â∞çË©±Âºè</option>
                            <option value="ÊïÖ‰∫ãÊÄß">ÊïÖ‰∫ãÊÄß</option>
                            <option value="ÊäΩË±°Ê¶ÇÂøµ">ÊäΩË±°Ê¶ÇÂøµ</option>
                            <option value="Âè£Ë™ûÂåñ">Âè£Ë™ûÂåñ</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">üé∫ Ê®ÇÂô®Á∑®Êéí <span class="selection-count" id="instrumentsCount"></span></label>
                    <div class="multi-select-container" id="instrumentsContainer">
                        <div class="multi-select-display" onclick="toggleDropdown('instruments')">
                            <div class="selected-items" id="instrumentsSelected">
                                <span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>
                            </div>
                            <span class="multi-select-arrow" id="instrumentsArrow">‚ñº</span>
                        </div>
                        <div class="multi-select-dropdown" id="instrumentsDropdown">
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üéπ ÈçµÁõ§</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Piano" value="Piano" onchange="updateMultiSelect('instruments')"><label for="i_Piano">Piano ÈãºÁê¥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Synth" value="Synthesizer" onchange="updateMultiSelect('instruments')"><label for="i_Synth">Synthesizer ÂêàÊàêÂô®</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Organ" value="Organ" onchange="updateMultiSelect('instruments')"><label for="i_Organ">Organ ÁÆ°È¢®Áê¥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Rhodes" value="Rhodes" onchange="updateMultiSelect('instruments')"><label for="i_Rhodes">Rhodes ÈõªÈãºÁê¥</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé∏ Âêâ‰ªñ/Âº¶Ê®Ç</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_AcousticGuitar" value="Acoustic Guitar" onchange="updateMultiSelect('instruments')"><label for="i_AcousticGuitar">Acoustic Guitar Êú®Âêâ‰ªñ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_ElectricGuitar" value="Electric Guitar" onchange="updateMultiSelect('instruments')"><label for="i_ElectricGuitar">Electric Guitar ÈõªÂêâ‰ªñ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Ukulele" value="Ukulele" onchange="updateMultiSelect('instruments')"><label for="i_Ukulele">Ukulele ÁÉèÂÖãÈ∫óÈ∫ó</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Violin" value="Violin" onchange="updateMultiSelect('instruments')"><label for="i_Violin">Violin Â∞èÊèêÁê¥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Cello" value="Cello" onchange="updateMultiSelect('instruments')"><label for="i_Cello">Cello Â§ßÊèêÁê¥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Strings" value="String Orchestra" onchange="updateMultiSelect('instruments')"><label for="i_Strings">String Orchestra Âº¶Ê®ÇÂúò</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Harp" value="Harp" onchange="updateMultiSelect('instruments')"><label for="i_Harp">Harp Ë±éÁê¥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Erhu" value="Erhu" onchange="updateMultiSelect('instruments')"><label for="i_Erhu">Erhu ‰∫åËÉ°</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Guzheng" value="Guzheng" onchange="updateMultiSelect('instruments')"><label for="i_Guzheng">Guzheng Âè§ÁÆè</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Pipa" value="Pipa" onchange="updateMultiSelect('instruments')"><label for="i_Pipa">Pipa ÁêµÁê∂</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé∏ Ë≤ùÊñØ</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Bass" value="Bass Guitar" onchange="updateMultiSelect('instruments')"><label for="i_Bass">Bass Guitar ÈõªË≤ùÊñØ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_SynthBass" value="Synth Bass" onchange="updateMultiSelect('instruments')"><label for="i_SynthBass">Synth Bass ÂêàÊàêË≤ùÊñØ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_808" value="808 Bass" onchange="updateMultiSelect('instruments')"><label for="i_808">808 Bass</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Upright" value="Upright Bass" onchange="updateMultiSelect('instruments')"><label for="i_Upright">Upright Bass ‰ΩéÈü≥ÊèêÁê¥</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">ü•Å ÊâìÊìä</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Drums" value="Drums" onchange="updateMultiSelect('instruments')"><label for="i_Drums">Drums ÁàµÂ£´Èºì</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_ElectronicDrums" value="Electronic Drums" onchange="updateMultiSelect('instruments')"><label for="i_ElectronicDrums">Electronic Drums ÈõªÂ≠êÈºì</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Percussion" value="Percussion" onchange="updateMultiSelect('instruments')"><label for="i_Percussion">Percussion ÊâìÊìäÊ®Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Congas" value="Congas" onchange="updateMultiSelect('instruments')"><label for="i_Congas">Congas Â∫∑Âä†Èºì</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Timpani" value="Timpani" onchange="updateMultiSelect('instruments')"><label for="i_Timpani">Timpani ÂÆöÈü≥Èºì</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Taiko" value="Taiko" onchange="updateMultiSelect('instruments')"><label for="i_Taiko">Taiko Â§™Èºì</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé∑ ÁÆ°Ê®Ç</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Saxophone" value="Saxophone" onchange="updateMultiSelect('instruments')"><label for="i_Saxophone">Saxophone Ëñ©ÂÖãÊñØÈ¢®</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Trumpet" value="Trumpet" onchange="updateMultiSelect('instruments')"><label for="i_Trumpet">Trumpet Â∞èËôü</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Trombone" value="Trombone" onchange="updateMultiSelect('instruments')"><label for="i_Trombone">Trombone Èï∑Ëôü</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Flute" value="Flute" onchange="updateMultiSelect('instruments')"><label for="i_Flute">Flute Èï∑Á¨õ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Clarinet" value="Clarinet" onchange="updateMultiSelect('instruments')"><label for="i_Clarinet">Clarinet ÂñÆÁ∞ßÁÆ°</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Harmonica" value="Harmonica" onchange="updateMultiSelect('instruments')"><label for="i_Harmonica">Harmonica Âè£Áê¥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Bagpipes" value="Bagpipes" onchange="updateMultiSelect('instruments')"><label for="i_Bagpipes">Bagpipes È¢®Á¨õ</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üéõÔ∏è ÈõªÂ≠ê/Áèæ‰ª£</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Pads" value="Synth Pads" onchange="updateMultiSelect('instruments')"><label for="i_Pads">Synth Pads ÂêàÊàêÂ¢äÈü≥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Arpeggio" value="Arpeggio" onchange="updateMultiSelect('instruments')"><label for="i_Arpeggio">Arpeggio Áê∂Èü≥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Lead" value="Lead Synth" onchange="updateMultiSelect('instruments')"><label for="i_Lead">Lead Synth ‰∏ªÂ•èÂêàÊàê</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_DrumMachine" value="Drum Machine" onchange="updateMultiSelect('instruments')"><label for="i_DrumMachine">Drum Machine ÈºìÊ©ü</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Sampler" value="Sampler" onchange="updateMultiSelect('instruments')"><label for="i_Sampler">Sampler ÂèñÊ®£Ê©ü</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_FX" value="Sound Effects" onchange="updateMultiSelect('instruments')"><label for="i_FX">Sound Effects Èü≥Êïà</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé§ ‰∫∫ËÅ≤ÂÖÉÁ¥†</div>
                                <div class="dropdown-option"><input type="checkbox" id="i_BackingVocals" value="Backing Vocals" onchange="updateMultiSelect('instruments')"><label for="i_BackingVocals">Backing Vocals ÂíåËÅ≤</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_Choir" value="Choir" onchange="updateMultiSelect('instruments')"><label for="i_Choir">Choir ÂêàÂî±Âúò</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="i_VocalChops" value="Vocal Chops" onchange="updateMultiSelect('instruments')"><label for="i_VocalChops">Vocal Chops ‰∫∫ËÅ≤ÂàáÁâá</label></div>
                            </div>
                            <div class="dropdown-actions">
                                <button type="button" onclick="clearAll('instruments')">Ê∏ÖÈô§ÂÖ®ÈÉ®</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ëº∏Âá∫Ë®≠ÂÆö -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üì§</div>
                <h2 class="card-title">Ëº∏Âá∫Ë®≠ÂÆö</h2>
            </div>

            <div class="form-group">
                <label class="form-label">üéµ ÁîüÊàêÊ®°Âºè</label>
                <div class="mode-selector">
                    <label class="mode-option">
                        <input type="radio" name="generateMode" value="single" checked onchange="toggleAlbumSettings()">
                        <div class="mode-card">
                            <div class="mode-icon">üé§</div>
                            <div class="mode-title">ÂñÆÊõ≤Ê®°Âºè</div>
                            <div class="mode-desc">ÁîüÊàê 1-3 ÂÄãÁâàÊú¨ÁöÑÊ≠åË©û</div>
                        </div>
                    </label>
                    <label class="mode-option">
                        <input type="radio" name="generateMode" value="album" onchange="toggleAlbumSettings()">
                        <div class="mode-card">
                            <div class="mode-icon">üíø</div>
                            <div class="mode-title">Â∞àËºØÊ®°Âºè</div>
                            <div class="mode-desc">ÁîüÊàêÂÆåÊï¥Â∞àËºØ (5-10È¶ñ)</div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- ÂñÆÊõ≤ÁâàÊú¨ÈÅ∏Êìá -->
            <div class="form-row-3" id="singleSettings">
                <div class="form-group">
                    <label class="form-label">‚è±Ô∏è Ê≠åÊõ≤ÊôÇÈï∑</label>
                    <select id="duration">
                        <option value="Short, 2 minutes">Áü≠Áâà 2ÂàÜÈêò</option>
                        <option value="Standard, 3 minutes" selected>Ê®ôÊ∫ñ 3ÂàÜÈêò</option>
                        <option value="Extended, 4-5 minutes">Âä†Èï∑ 4-5ÂàÜÈêò</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">üî¢ ÁîüÊàêÁâàÊú¨Êï∏</label>
                    <select id="count">
                        <option value="1">1 ÂÄãÁâàÊú¨</option>
                        <option value="2">2 ÂÄãÁâàÊú¨</option>
                        <option value="3">3 ÂÄãÁâàÊú¨</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">üéØ ÂâµÊÑèÁ®ãÂ∫¶</label>
                    <select id="creativity">
                        <option value="0.7">‰øùÂÆà (Á©©ÂÆö)</option>
                        <option value="0.85" selected>Âπ≥Ë°°</option>
                        <option value="0.95">Â§ßËÜΩ (ÂâµÊÑè)</option>
                        <option value="1.0">ÂØ¶È©óÊÄß</option>
                    </select>
                </div>
            </div>

            <!-- Â∞àËºØË®≠ÂÆö -->
            <div class="album-count-section" id="albumSettings">
                <div class="album-count-header">
                    <span class="album-count-label">üíø Â∞àËºØÊ≠åÊõ≤Êï∏Èáè</span>
                    <span class="album-count-value" id="albumCountValue">7 È¶ñ</span>
                </div>
                <input type="range" class="album-count-slider" id="albumCount" min="5" max="10" value="7" oninput="updateAlbumCount()">
                <div class="slider-labels">
                    <span>5È¶ñ</span>
                    <span>10È¶ñ</span>
                </div>
                
                <div class="form-row" style="margin-top: 20px;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">‚è±Ô∏è ÂñÆÊõ≤ÊôÇÈï∑</label>
                        <select id="albumDuration">
                            <option value="Short, 2 minutes">Áü≠Áâà 2ÂàÜÈêò</option>
                            <option value="Standard, 3 minutes" selected>Ê®ôÊ∫ñ 3ÂàÜÈêò</option>
                            <option value="Extended, 4-5 minutes">Âä†Èï∑ 4-5ÂàÜÈêò</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">üéØ ÂâµÊÑèÁ®ãÂ∫¶</label>
                        <select id="albumCreativity">
                            <option value="0.7">‰øùÂÆà (Á©©ÂÆö)</option>
                            <option value="0.85" selected>Âπ≥Ë°°</option>
                            <option value="0.95">Â§ßËÜΩ (ÂâµÊÑè)</option>
                            <option value="1.0">ÂØ¶È©óÊÄß</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">üìù È°çÂ§ñË¶ÅÊ±Ç <span class="label-hint">ÔºàÈÅ∏Â°´Ôºâ</span></label>
                <textarea id="requirements" placeholder="‰æãÂ¶Ç:Âä†ÂÖ•ËΩâÈü≥ÊäÄÂ∑ß„ÄÅÁâπÂÆöÊäºÈüªÊñπÂºè„ÄÅÊüêÁ®ÆÊÉÖÂ¢ÉÊèèÂØ´..."></textarea>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="randomFill()">üé≤ Èö®Ê©üÈùàÊÑü</button>
                <button class="btn btn-primary" id="generateBtn" onclick="generateLyrics()">‚ú® ÈñãÂßãÁîüÊàê</button>
            </div>
        </div>

        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p class="loading-text">AI Ê≠£Âú®ÁÇ∫‰Ω†Ââµ‰Ωú‰∏≠...</p>
        </div>

        <!-- ÁµêÊûúÂçÄÂüü -->
        <div class="result-section" id="resultSection">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üé∂</div>
                    <h2 class="card-title">ÁîüÊàêÁµêÊûú</h2>
                </div>
                
                <!-- Â∞àËºØË≥áË®ä (Â∞àËºØÊ®°ÂºèÈ°ØÁ§∫) -->
                <div class="album-info" id="albumInfo" style="display: none;">
                    <div class="album-name" id="albumName"></div>
                    <div class="album-meta" id="albumMeta"></div>
                </div>
                
                <!-- ÂñÆÊõ≤ÁâàÊú¨Ê®ôÁ±§ -->
                <div class="version-tabs" id="versionTabs"></div>
                
                <!-- Ê≠åÊõ≤ÂàóË°® (Â∞àËºØÊ®°Âºè) -->
                <div class="track-list" id="trackList"></div>
                
                <!-- ÂñÆÊõ≤ÂÖßÂÆπÂÆπÂô® -->
                <div id="versionsContainer"></div>
            </div>
        </div>

        <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importLyrics(event)">

        <!-- Ë©ûÂ∫´ÂçÄÂüü -->
        <div class="library-section">
            <div class="library-header">
                <h2 class="library-title">üìö ÊàëÁöÑË©ûÂ∫´ <span class="library-count" id="libCount">0</span></h2>
                <div class="global-actions">
                    <button class="import-btn" onclick="document.getElementById('importFile').click()">üì• ÂåØÂÖ•</button>
                    <button class="export-btn" onclick="exportLibrary()">üì§ ÂåØÂá∫</button>
                </div>
            </div>
            <div id="libraryList" class="library-list"></div>
        </div>

        <input type="file" id="importLibraryFile" accept=".json" style="display: none;" onchange="importLibrary(event)">

        <div class="tips-card">
            <div class="tips-header">üí° ‰ΩøÁî®ÊèêÁ§∫</div>
            <ul class="tips-list">
                <li>ÂñÆÊõ≤Ê®°ÂºèÂèØÁîüÊàê 1-3 ÂÄã‰∏çÂêåÈ¢®Ê†ºÁöÑÁâàÊú¨</li>
                <li>Â∞àËºØÊ®°ÂºèÂèØ‰∏ÄÊ¨°ÁîüÊàê 5-10 È¶ñÂÆåÊï¥Ê≠åÊõ≤ÔºåÂåÖÂê´Â∞àËºØÂêçÁ®±ÂíåÊ≠åÂêç</li>
                <li>ÈªûÊìäÂ∞àËºØ‰∏≠ÁöÑÊ≠åÊõ≤ÊåâÈàïÂèØÂ±ïÈñã/Êî∂ÂêàÊ≠åË©ûÂÖßÂÆπ</li>
                <li>Á¥îÈü≥Ê®ÇÊ®°ÂºèÊúÉÁîüÊàêÈü≥Ê®ÇÁµêÊßãÊèèËø∞ÔºåÈÅ©ÂêàÈÖçÊ®ÇË£Ω‰Ωú</li>
                <li>ÊâÄÊúâË®≠ÂÆöÊúÉËá™ÂãïÂÑ≤Â≠òÔºåÈáçÊñ∞Êï¥ÁêÜ‰∏çÊúÉÈÅ∫Â§±</li>
            </ul>
        </div>

        <footer class="footer">
            <p>Powered by Google Gemini AI ¬∑ Made with ‚ù§Ô∏è</p>
        </footer>
    </div>

    <button class="settings-btn" onclick="openApiModal()" title="API Ë®≠ÂÆö">‚öôÔ∏è</button>

    <!-- API Modal -->
    <div id="apiModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîë API ÈáëÈë∞Ë®≠ÂÆö</h2>
                <p>Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ Google Gemini API ÈáëÈë∞</p>
            </div>
            <div class="info-box">
                <p><strong>Â¶Ç‰ΩïÂèñÂæó?</strong></p>
                <p>1. ÂâçÂæÄ <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a></p>
                <p>2. ÁôªÂÖ•‰∏¶Âª∫Á´ã API Key</p>
            </div>
            <div class="modal-body">
                <input type="password" id="apiKeyInput" placeholder="AIza..." autocomplete="off">
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeApiModal()">ÂèñÊ∂à</button>
                <button class="modal-btn modal-btn-primary" onclick="saveApiKey()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>

    <script>
        // ===== ÂÖ®ÂüüËÆäÊï∏ =====
        let db = null;
        const DB_NAME = 'LyricsGeneratorProDB';
        const DB_VERSION = 2;
        const STORE_NAME = 'formState';
        const API_KEY_STORE = 'apiKeyStore';
        const LIBRARY_STORE = 'libraryStore';
        let generatedVersions = [];
        let generatedAlbum = null;
        let savedSongs = [];

        // ===== IndexedDB =====
        async function initIndexedDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                request.onerror = () => reject(request.error);
                request.onsuccess = () => { db = request.result; resolve(db); };
                request.onupgradeneeded = (event) => {
                    const database = event.target.result;
                    if (!database.objectStoreNames.contains(STORE_NAME)) database.createObjectStore(STORE_NAME);
                    if (!database.objectStoreNames.contains(API_KEY_STORE)) database.createObjectStore(API_KEY_STORE);
                    if (!database.objectStoreNames.contains(LIBRARY_STORE)) database.createObjectStore(LIBRARY_STORE);
                };
            });
        }

        function saveToIndexedDB(storeName, key, data) {
            return new Promise((resolve, reject) => {
                if (!db) return reject(new Error('DB not ready'));
                const tx = db.transaction(storeName, 'readwrite');
                tx.objectStore(storeName).put(data, key).onsuccess = () => resolve();
            });
        }

        function loadFromIndexedDB(storeName, key) {
            return new Promise((resolve, reject) => {
                if (!db) return reject(new Error('DB not ready'));
                const tx = db.transaction(storeName, 'readonly');
                const request = tx.objectStore(storeName).get(key);
                request.onsuccess = () => resolve(request.result);
            });
        }

        // ===== ÊäòÁñäÂçÄÂ°ä =====
        function toggleSection(id) {
            const section = document.getElementById(`${id}Section`);
            const toggle = section.previousElementSibling;
            const arrow = document.getElementById(`${id}ArrowIcon`);
            
            section.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        // ===== Ê≠åÊõ≤È°ûÂûãÂàáÊèõ =====
        document.querySelectorAll('input[name="songType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const vocalSection = document.getElementById('vocalSection');
                const vocalToggle = vocalSection.previousElementSibling;
                if (this.value === 'instrumental') {
                    vocalToggle.style.opacity = '0.5';
                    vocalToggle.style.pointerEvents = 'none';
                } else {
                    vocalToggle.style.opacity = '1';
                    vocalToggle.style.pointerEvents = 'auto';
                }
                saveFormState();
            });
        });

        // ===== ÁîüÊàêÊ®°ÂºèÂàáÊèõ =====
        function toggleAlbumSettings() {
            const mode = document.querySelector('input[name="generateMode"]:checked').value;
            const singleSettings = document.getElementById('singleSettings');
            const albumSettings = document.getElementById('albumSettings');
            
            if (mode === 'album') {
                singleSettings.style.display = 'none';
                albumSettings.classList.add('show');
            } else {
                singleSettings.style.display = '';
                albumSettings.classList.remove('show');
            }
            saveFormState();
        }

        function updateAlbumCount() {
            const count = document.getElementById('albumCount').value;
            document.getElementById('albumCountValue').textContent = count + ' È¶ñ';
            saveFormState();
        }

        // ===== Â§öÈÅ∏‰∏ãÊãâÂºè =====
        function toggleDropdown(type) {
            const dropdown = document.getElementById(`${type}Dropdown`);
            const arrow = document.getElementById(`${type}Arrow`);
            const display = dropdown.previousElementSibling;
            const isOpen = dropdown.classList.contains('show');
            
            document.querySelectorAll('.multi-select-dropdown').forEach(d => d.classList.remove('show'));
            document.querySelectorAll('.multi-select-arrow').forEach(a => a.classList.remove('open'));
            document.querySelectorAll('.multi-select-display').forEach(d => d.classList.remove('active'));
            
            if (!isOpen) {
                dropdown.classList.add('show');
                arrow.classList.add('open');
                display.classList.add('active');
            }
        }

        function updateMultiSelect(type) {
            const container = document.getElementById(`${type}Container`);
            const selectedDiv = document.getElementById(`${type}Selected`);
            const countSpan = document.getElementById(`${type}Count`);
            
            const checkboxes = container.querySelectorAll('input[type="checkbox"]');
            const selectedValues = [];
            
            checkboxes.forEach(cb => {
                if (cb.checked) selectedValues.push(cb.value);
                cb.closest('.dropdown-option')?.classList.toggle('selected', cb.checked);
            });
            
            if (selectedValues.length === 0) {
                selectedDiv.innerHTML = `<span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>`;
                if (countSpan) countSpan.textContent = '';
            } else {
                selectedDiv.innerHTML = selectedValues.map(v => 
                    `<span class="selected-tag">${v}<span class="remove-tag" onclick="event.stopPropagation(); removeSelection('${type}', '${v}')">√ó</span></span>`
                ).join('');
                if (countSpan) countSpan.textContent = `Â∑≤ÈÅ∏ ${selectedValues.length}`;
            }
            saveFormState();
        }

        function removeSelection(type, value) {
            const container = document.getElementById(`${type}Container`);
            const checkbox = container.querySelector(`input[value="${value}"]`);
            if (checkbox) {
                checkbox.checked = false;
                updateMultiSelect(type);
            }
        }

        function clearAll(type) {
            const container = document.getElementById(`${type}Container`);
            container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateMultiSelect(type);
        }

        function getSelectedValues(type) {
            const container = document.getElementById(`${type}Container`);
            return Array.from(container.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
        }

        // ÈóúÈñâ‰∏ãÊãâÈÅ∏ÂñÆ
        document.addEventListener('click', e => {
            if (!e.target.closest('.multi-select-container')) {
                document.querySelectorAll('.multi-select-dropdown').forEach(d => d.classList.remove('show'));
                document.querySelectorAll('.multi-select-arrow').forEach(a => a.classList.remove('open'));
                document.querySelectorAll('.multi-select-display').forEach(d => d.classList.remove('active'));
            }
        });

        // ===== Ë°®ÂñÆÁãÄÊÖãÁÆ°ÁêÜ =====
        async function saveFormState() {
            const state = {
                theme: document.getElementById('theme').value,
                songType: document.querySelector('input[name="songType"]:checked')?.value,
                generateMode: document.querySelector('input[name="generateMode"]:checked')?.value,
                genre: getSelectedValues('genre'),
                mood: getSelectedValues('mood'),
                instruments: getSelectedValues('instruments'),
                bpm: document.getElementById('bpm').value,
                era: document.getElementById('era').value,
                key: document.getElementById('key').value,
                region: document.getElementById('region').value,
                production: document.getElementById('production').value,
                technique: document.getElementById('technique').value,
                voice: document.getElementById('voice').value,
                language: document.getElementById('language').value,
                vocalEffect: document.getElementById('vocalEffect').value,
                structure: document.getElementById('structure').value,
                lyricStyle: document.getElementById('lyricStyle').value,
                duration: document.getElementById('duration').value,
                count: document.getElementById('count').value,
                creativity: document.getElementById('creativity').value,
                albumCount: document.getElementById('albumCount').value,
                albumDuration: document.getElementById('albumDuration').value,
                albumCreativity: document.getElementById('albumCreativity').value,
                requirements: document.getElementById('requirements').value
            };
            try {
                await saveToIndexedDB(STORE_NAME, 'formState', state);
            } catch (e) {
                console.warn('Save state failed:', e);
            }
        }

        async function loadFormState() {
            try {
                const state = await loadFromIndexedDB(STORE_NAME, 'formState');
                if (!state) return;

                if (state.theme) document.getElementById('theme').value = state.theme;
                if (state.songType) {
                    const radio = document.querySelector(`input[name="songType"][value="${state.songType}"]`);
                    if (radio) { radio.checked = true; radio.dispatchEvent(new Event('change')); }
                }
                if (state.generateMode) {
                    const radio = document.querySelector(`input[name="generateMode"][value="${state.generateMode}"]`);
                    if (radio) { radio.checked = true; toggleAlbumSettings(); }
                }

                ['genre', 'mood', 'instruments'].forEach(type => {
                    if (state[type]) {
                        state[type].forEach(val => {
                            const cb = document.querySelector(`#${type}Container input[value="${val}"]`);
                            if (cb) cb.checked = true;
                        });
                        updateMultiSelect(type);
                    }
                });

                ['bpm', 'era', 'key', 'region', 'production', 'technique', 'voice', 'language', 'vocalEffect', 'structure', 'lyricStyle', 'duration', 'count', 'creativity', 'albumDuration', 'albumCreativity', 'requirements'].forEach(id => {
                    if (state[id]) document.getElementById(id).value = state[id];
                });

                if (state.albumCount) {
                    document.getElementById('albumCount').value = state.albumCount;
                    updateAlbumCount();
                }
            } catch (e) {
                console.warn('Load state failed:', e);
            }
        }

        // ===== API ÁÆ°ÁêÜ =====
        function openApiModal() { document.getElementById('apiModal').classList.add('show'); }
        function closeApiModal() { document.getElementById('apiModal').classList.remove('show'); }

        async function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if (!key) { alert('Ë´ãËº∏ÂÖ• API ÈáëÈë∞'); return; }
            try {
                await saveToIndexedDB(API_KEY_STORE, 'apiKey', key);
                alert('‚úÖ API ÈáëÈë∞Â∑≤ÂÑ≤Â≠ò!');
                closeApiModal();
            } catch (e) {
                alert('ÂÑ≤Â≠òÂ§±Êïó: ' + e.message);
            }
        }

        async function getApiKey() {
            try { return await loadFromIndexedDB(API_KEY_STORE, 'apiKey'); }
            catch { return null; }
        }

        // ===== È¢®Ê†ºÊèêÁ§∫Ë©ûÁîüÊàê =====
        function shuffleArray(arr) {
            const newArr = [...arr];
            for (let i = newArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
            }
            return newArr;
        }

        function generateUniqueStylePrompts(count, settings) {
            const prompts = [];
            
            for (let i = 0; i < count; i++) {
                const parts = [];
                
                if (settings.genre.length > 0) {
                    const shuffled = shuffleArray(settings.genre);
                    parts.push(shuffled.slice(0, Math.min(2, shuffled.length)).join(', '));
                }
                
                if (settings.mood.length > 0) {
                    const shuffled = shuffleArray(settings.mood);
                    parts.push(shuffled.slice(0, Math.min(2, shuffled.length)).join(', '));
                }
                
                if (settings.instruments.length > 0) {
                    const shuffled = shuffleArray(settings.instruments);
                    parts.push(shuffled.slice(0, Math.min(3, shuffled.length)).join(', '));
                }
                
                if (settings.bpm) parts.push(settings.bpm);
                if (settings.era) parts.push(settings.era);
                if (settings.key) parts.push(settings.key);
                if (settings.region) parts.push(settings.region);
                if (settings.production) parts.push(settings.production);
                if (settings.vocalEffect && !settings.isInstrumental) parts.push(settings.vocalEffect);
                
                if (settings.isInstrumental) {
                    parts.push('Instrumental');
                } else {
                    parts.push(settings.voice);
                }
                
                const modifiers = ['Emotional', 'Melodic', 'Groovy', 'Atmospheric', 'Powerful', 'Soft', 'Energetic', 'Cinematic', 'Catchy', 'Anthemic'];
                if (Math.random() > 0.4) {
                    parts.push(modifiers[Math.floor(Math.random() * modifiers.length)]);
                }
                
                prompts.push(shuffleArray(parts).join(', '));
            }
            
            return prompts;
        }

        // ===== Ê≠åË©ûÁîüÊàê =====
        async function generateLyrics() {
            const theme = document.getElementById('theme').value.trim();
            if (!theme) { alert('Ë´ãËº∏ÂÖ•Ê≠åÊõ≤‰∏ªÈ°å'); return; }

            const apiKey = await getApiKey();
            if (!apiKey) { alert('Ë´ãÂÖàË®≠ÂÆö API ÈáëÈë∞'); openApiModal(); return; }

            const isInstrumental = document.querySelector('input[name="songType"]:checked').value === 'instrumental';
            const generateMode = document.querySelector('input[name="generateMode"]:checked').value;
            
            const isAlbumMode = generateMode === 'album';
            const count = isAlbumMode ? parseInt(document.getElementById('albumCount').value) : parseInt(document.getElementById('count').value);
            const creativity = parseFloat(isAlbumMode ? document.getElementById('albumCreativity').value : document.getElementById('creativity').value);
            const duration = isAlbumMode ? document.getElementById('albumDuration').value : document.getElementById('duration').value;
            
            const settings = {
                theme,
                isInstrumental,
                genre: getSelectedValues('genre'),
                mood: getSelectedValues('mood'),
                instruments: getSelectedValues('instruments'),
                bpm: document.getElementById('bpm').value,
                era: document.getElementById('era').value,
                key: document.getElementById('key').value,
                region: document.getElementById('region').value,
                production: document.getElementById('production').value,
                structure: document.getElementById('structure').value,
                technique: document.getElementById('technique').value,
                voice: document.getElementById('voice').value,
                language: document.getElementById('language').value,
                vocalEffect: document.getElementById('vocalEffect').value,
                lyricStyle: document.getElementById('lyricStyle').value,
                duration: duration,
                requirements: document.getElementById('requirements').value
            };

            document.getElementById('generateBtn').disabled = true;
            document.getElementById('loading').classList.add('show');
            document.getElementById('resultSection').classList.remove('show');

            const stylePrompts = generateUniqueStylePrompts(count, settings);

            let prompt;
            if (isAlbumMode) {
                // Â∞àËºØÊ®°ÂºèÊèêÁ§∫Ë©û
                if (isInstrumental) {
                    prompt = `‰Ω†ÊòØÂ∞àÊ•≠Èü≥Ê®ÇË£Ω‰Ωú‰∫∫,Ë´ãÊ†πÊìö‰ª•‰∏ãË®≠ÂÆöÂâµ‰Ωú‰∏ÄÂºµÁ¥îÈü≥Ê®ÇÂ∞àËºØ:

„ÄêË®≠ÂÆö„Äë
- Â∞àËºØ‰∏ªÈ°å/Ê¶ÇÂøµ:${theme}
- È¢®Ê†º:${settings.genre.join(', ') || 'Ëá™Âãï'}
- ÊÉÖÊÑü:${settings.mood.join(', ') || 'Ëá™Âãï'}
- Ê®ÇÂô®:${settings.instruments.join(', ') || 'Ëá™Âãï'}
- ÁØÄÂ•è:${settings.bpm || 'Ëá™Âãï'}
- Âπ¥‰ª£:${settings.era || 'Ëá™Âãï'}
- Ë™øÊÄß:${settings.key || 'Ëá™Âãï'}
- Âú∞Âüü:${settings.region || 'Ëá™Âãï'}
- Ë≥™ÊÑü:${settings.production || 'Ëá™Âãï'}
- ÊôÇÈï∑:${duration}
${settings.requirements ? `- È°çÂ§ñË¶ÅÊ±Ç:${settings.requirements}` : ''}

Ë´ãÁîüÊàê‰∏ÄÂºµ ${count} È¶ñÊ≠åÁöÑÂ∞àËºØ,Ê†ºÂºèÂ¶Ç‰∏ã:

„ÄêÂ∞àËºØÂêçÁ®±„Äë(Ë´ãÂèñ‰∏ÄÂÄãÊúâÂâµÊÑèÁöÑÂ∞àËºØÂêç)

=== Á¨¨ 1 È¶ñ ===
„ÄêÊ≠åÂêç„Äë(Âèñ‰∏ÄÂÄãÊúâÊÑèÁæ©ÁöÑÊ≠åÂêç)
„ÄêÊ≠åË©û/ÁµêÊßã„Äë
(‰ΩøÁî® Suno Ê®ôÁ±§Â¶Ç [Intro], [Main Theme], [Build Up], [Drop], [Breakdown], [Bridge], [Outro])

=== Á¨¨ 2 È¶ñ ===
...‰ª•Ê≠§È°ûÊé®

ÊØèÈ¶ñÊ≠åÈÉΩË¶ÅÊúâÁç®ÁâπÁöÑÈ¢®Ê†ºÂíåÂÖßÂÆπ,‰ΩÜÊï¥È´îË¶ÅÁ¨¶ÂêàÂ∞àËºØ‰∏ªÈ°å„ÄÇ`;
                } else {
                    prompt = `‰Ω†ÊòØÂ∞àÊ•≠Ê≠åË©ûÂâµ‰ΩúËÄÖ,Ë´ãÊ†πÊìö‰ª•‰∏ãË®≠ÂÆöÂâµ‰Ωú‰∏ÄÂºµÂÆåÊï¥Â∞àËºØ:

„ÄêË®≠ÂÆö„Äë
- Â∞àËºØ‰∏ªÈ°å/Ê¶ÇÂøµ:${theme}
- È¢®Ê†º:${settings.genre.join(', ') || 'Ëá™Âãï'}
- ÊÉÖÊÑü:${settings.mood.join(', ') || 'Ëá™Âãï'}
- Ê®ÇÂô®:${settings.instruments.join(', ') || 'Ëá™Âãï'}
- ÁØÄÂ•è:${settings.bpm || 'Ëá™Âãï'}
- Âπ¥‰ª£:${settings.era || 'Ëá™Âãï'}
- Ë™øÊÄß:${settings.key || 'Ëá™Âãï'}
- Âú∞Âüü:${settings.region || 'Ëá™Âãï'}
- Ë≥™ÊÑü:${settings.production || 'Ëá™Âãï'}
- ÁµêÊßã:${settings.structure || 'Ê®ôÊ∫ñ'}
- ÊºîÂî±:${settings.voice}
- Ë™ûË®Ä:${settings.language}
- ‰∫∫ËÅ≤ÊïàÊûú:${settings.vocalEffect || 'Ëá™ÁÑ∂'}
- Ê≠åË©ûÈ¢®Ê†º:${settings.lyricStyle || 'Ëá™Âãï'}
- ÊôÇÈï∑:${duration}
${settings.requirements ? `- È°çÂ§ñË¶ÅÊ±Ç:${settings.requirements}` : ''}

Ë´ãÁîüÊàê‰∏ÄÂºµ ${count} È¶ñÊ≠åÁöÑÂ∞àËºØ,Ê†ºÂºèÂ¶Ç‰∏ã:

„ÄêÂ∞àËºØÂêçÁ®±„Äë(Ë´ãÂèñ‰∏ÄÂÄãÊúâÂâµÊÑèÁöÑÂ∞àËºØÂêç)

=== Á¨¨ 1 È¶ñ ===
„ÄêÊ≠åÂêç„Äë(Âèñ‰∏ÄÂÄãÊúâÊÑèÁæ©ÁöÑÊ≠åÂêç)
„ÄêÊ≠åË©û„Äë
(‰ΩøÁî® Suno Ê®ôÁ±§:[Intro], [Verse 1], [Pre-Chorus], [Chorus], [Verse 2], [Bridge], [Outro] Á≠â)

=== Á¨¨ 2 È¶ñ ===
...‰ª•Ê≠§È°ûÊé®

ÊØèÈ¶ñÊ≠åÈÉΩË¶ÅÊúâÁç®ÁâπÁöÑÈ¢®Ê†ºÂíåÂÖßÂÆπ,‰ΩÜÊï¥È´îË¶ÅÁ¨¶ÂêàÂ∞àËºØÊ¶ÇÂøµ,ÊúâÈÄ£Ë≤´ÊÄß„ÄÇ`;
                }
            } else {
                // ÂñÆÊõ≤Ê®°ÂºèÊèêÁ§∫Ë©û
                if (isInstrumental) {
                    prompt = `‰Ω†ÊòØÂ∞àÊ•≠Èü≥Ê®ÇË£Ω‰Ωú‰∫∫,Ë´ãÊ†πÊìö‰ª•‰∏ãË®≠ÂÆöÂâµ‰ΩúÁ¥îÈü≥Ê®ÇÁµêÊßã:

„ÄêË®≠ÂÆö„Äë
- ‰∏ªÈ°å/Ê∞õÂúç:${theme}
- È¢®Ê†º:${settings.genre.join(', ') || 'Ëá™Âãï'}
- ÊÉÖÊÑü:${settings.mood.join(', ') || 'Ëá™Âãï'}
- Ê®ÇÂô®:${settings.instruments.join(', ') || 'Ëá™Âãï'}
- ÁØÄÂ•è:${settings.bpm || 'Ëá™Âãï'}
- Âπ¥‰ª£:${settings.era || 'Ëá™Âãï'}
- Ë™øÊÄß:${settings.key || 'Ëá™Âãï'}
- Âú∞Âüü:${settings.region || 'Ëá™Âãï'}
- Ë≥™ÊÑü:${settings.production || 'Ëá™Âãï'}
- ÁµêÊßã:${settings.structure || 'Ê®ôÊ∫ñ'}
- ÁâπÊÆäÊäÄÊ≥ï:${settings.technique || 'ÁÑ°'}
- ÊôÇÈï∑:${duration}
${settings.requirements ? `- È°çÂ§ñË¶ÅÊ±Ç:${settings.requirements}` : ''}

„ÄêËº∏Âá∫Ê†ºÂºè„Äë‰ΩøÁî® Suno Ê®ôÁ±§Â¶Ç [Intro], [Main Theme], [Build Up], [Drop], [Breakdown], [Bridge], [Outro]
Âú®ÊØèÂÄãÊÆµËêΩÂæåÁî®Êã¨ËôüÊèèËø∞Ë©≤ÊÆµÈü≥Ê®ÇÁâπÈªû„ÄÇ

Ë´ãÁîüÊàê ${count} ÂÄã‰∏çÂêåÁâàÊú¨,Áî® "=== ÁâàÊú¨ X ===" ÂàÜÈöî„ÄÇ`;
                } else {
                    prompt = `‰Ω†ÊòØÂ∞àÊ•≠Ê≠åË©ûÂâµ‰ΩúËÄÖ,Ë´ãÊ†πÊìö‰ª•‰∏ãË®≠ÂÆöÂâµ‰ΩúÊ≠åË©û:

„ÄêË®≠ÂÆö„Äë
- ‰∏ªÈ°å:${theme}
- È¢®Ê†º:${settings.genre.join(', ') || 'Ëá™Âãï'}
- ÊÉÖÊÑü:${settings.mood.join(', ') || 'Ëá™Âãï'}
- Ê®ÇÂô®:${settings.instruments.join(', ') || 'Ëá™Âãï'}
- ÁØÄÂ•è:${settings.bpm || 'Ëá™Âãï'}
- Âπ¥‰ª£:${settings.era || 'Ëá™Âãï'}
- Ë™øÊÄß:${settings.key || 'Ëá™Âãï'}
- Âú∞Âüü:${settings.region || 'Ëá™Âãï'}
- Ë≥™ÊÑü:${settings.production || 'Ëá™Âãï'}
- ÁµêÊßã:${settings.structure || 'Ê®ôÊ∫ñ'}
- ÁâπÊÆäÊäÄÊ≥ï:${settings.technique || 'ÁÑ°'}
- ÊºîÂî±:${settings.voice}
- Ë™ûË®Ä:${settings.language}
- ‰∫∫ËÅ≤ÊïàÊûú:${settings.vocalEffect || 'Ëá™ÁÑ∂'}
- Ê≠åË©ûÈ¢®Ê†º:${settings.lyricStyle || 'Ëá™Âãï'}
- ÊôÇÈï∑:${duration}
${settings.requirements ? `- È°çÂ§ñË¶ÅÊ±Ç:${settings.requirements}` : ''}

„ÄêËº∏Âá∫Ê†ºÂºè„Äë‰ΩøÁî® Suno Ê®ôÁ±§:[Intro], [Verse 1], [Pre-Chorus], [Chorus], [Verse 2], [Bridge], [Outro] Á≠â

Ë´ãÁîüÊàê ${count} ÂÄã‰∏çÂêåÁâàÊú¨,ÊØèÂÄãÁâàÊú¨È¢®Ê†ºÂíåÂÖßÂÆπË¶ÅÊúâÂ∑ÆÁï∞,Áî® "=== ÁâàÊú¨ X ===" ÂàÜÈöî„ÄÇ`;
                }
            }

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: {
                            temperature: creativity,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 16384,
                        }
                    })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);

                const fullText = data.candidates[0].content.parts[0].text;
                
                if (isAlbumMode) {
                    // Ëß£ÊûêÂ∞àËºØÊ†ºÂºè
                    const albumNameMatch = fullText.match(/„ÄêÂ∞àËºØÂêçÁ®±„Äë[Ôºö:]*\s*(.+)/);
                    const albumName = albumNameMatch ? albumNameMatch[1].trim() : theme;
                    
                    const trackParts = fullText.split(/===\s*Á¨¨\s*\d+\s*È¶ñ\s*===/);
                    const tracks = [];
                    
                    for (let i = 1; i < trackParts.length; i++) {
                        const part = trackParts[i].trim();
                        const titleMatch = part.match(/„ÄêÊ≠åÂêç„Äë[Ôºö:]*\s*(.+)/);
                        const title = titleMatch ? titleMatch[1].trim() : `Track ${i}`;
                        
                        let lyrics = part.replace(/„ÄêÊ≠åÂêç„Äë[Ôºö:]*\s*.+\n?/, '').replace(/„ÄêÊ≠åË©û[\/ÁµêÊßã]*„Äë\n?/g, '').trim();
                        
                        tracks.push({
                            title,
                            lyrics,
                            stylePrompt: stylePrompts[i - 1] || stylePrompts[0]
                        });
                    }
                    
                    generatedAlbum = { name: albumName, tracks };
                    generatedVersions = [];
                    renderAlbum(generatedAlbum);
                } else {
                    // Ëß£ÊûêÂñÆÊõ≤ÁâàÊú¨Ê†ºÂºè
                    let versions = [];
                    if (count > 1) {
                        const parts = fullText.split(/===\s*ÁâàÊú¨\s*\d+\s*===/);
                        versions = parts.filter(p => p.trim()).map((text, idx) => ({
                            lyrics: text.trim(),
                            stylePrompt: stylePrompts[idx] || stylePrompts[0]
                        }));
                    } else {
                        versions = [{ lyrics: fullText.trim(), stylePrompt: stylePrompts[0] }];
                    }
                    
                    generatedVersions = versions;
                    generatedAlbum = null;
                    renderVersions(versions);
                }
                
                document.getElementById('resultSection').classList.add('show');
                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                alert('ÁîüÊàêÂ§±Êïó:' + error.message);
            } finally {
                document.getElementById('generateBtn').disabled = false;
                document.getElementById('loading').classList.remove('show');
            }
        }

        // ===== Ê∏≤ÊüìÂñÆÊõ≤ÁµêÊûú =====
        function renderVersions(versions) {
            document.getElementById('albumInfo').style.display = 'none';
            document.getElementById('trackList').innerHTML = '';
            
            document.getElementById('versionTabs').innerHTML = versions.map((_, i) => 
                `<button class="version-tab ${i === 0 ? 'active' : ''}" onclick="switchVersion(${i})">üéµ ÁâàÊú¨ ${i + 1}</button>`
            ).join('');
            
            document.getElementById('versionsContainer').innerHTML = versions.map((v, i) => `
                <div class="version-content ${i === 0 ? 'active' : ''}" id="version-${i}">
                    <div class="style-prompt-section">
                        <div class="style-prompt-header">üé® Suno È¢®Ê†ºÊèêÁ§∫Ë©û</div>
                        <div class="style-prompt-output">${v.stylePrompt}</div>
                        <button class="copy-style-prompt-btn" onclick="copyText('${encodeURIComponent(v.stylePrompt)}', this)">üìã Ë§áË£ΩÊèêÁ§∫Ë©û</button>
                    </div>
                    <pre class="lyrics-output">${escapeHtml(v.lyrics)}</pre>
                    <div class="action-buttons">
                        <button class="action-btn copy-btn" onclick="copyLyrics(${i})">üìã Ë§áË£Ω</button>
                        <button class="action-btn suno-btn" onclick="window.open('https://suno.com/create','_blank')">üöÄ Suno</button>
                        <button class="action-btn export-btn" onclick="exportVersion(${i})">üíæ ÂåØÂá∫</button>
                        <button class="action-btn add-lib-btn" onclick="addToLibrary(${i})">üìö Êî∂Ëóè</button>
                    </div>
                </div>
            `).join('');
        }

        // ===== Ê∏≤ÊüìÂ∞àËºØÁµêÊûú =====
        function renderAlbum(album) {
            document.getElementById('versionTabs').innerHTML = '';
            document.getElementById('versionsContainer').innerHTML = '';
            
            document.getElementById('albumInfo').style.display = 'block';
            document.getElementById('albumName').textContent = album.name;
            document.getElementById('albumMeta').textContent = `ÂÖ± ${album.tracks.length} È¶ñÊ≠åÊõ≤`;
            
            document.getElementById('trackList').innerHTML = album.tracks.map((track, i) => `
                <div class="track-item" id="track-${i}">
                    <div class="track-header" onclick="toggleTrack(${i})">
                        <div class="track-number">${i + 1}</div>
                        <div class="track-info">
                            <div class="track-title">${escapeHtml(track.title)}</div>
                            <div class="track-style">${track.stylePrompt}</div>
                        </div>
                        <div class="track-toggle">‚ñº</div>
                    </div>
                    <div class="track-content">
                        <div class="style-prompt-section">
                            <div class="style-prompt-header">üé® Suno È¢®Ê†ºÊèêÁ§∫Ë©û</div>
                            <div class="style-prompt-output">${track.stylePrompt}</div>
                            <button class="copy-style-prompt-btn" onclick="copyText('${encodeURIComponent(track.stylePrompt)}', this)">üìã Ë§áË£ΩÊèêÁ§∫Ë©û</button>
                        </div>
                        <pre class="lyrics-output">${escapeHtml(track.lyrics)}</pre>
                        <div class="action-buttons">
                            <button class="action-btn copy-btn" onclick="copyTrackLyrics(${i})">üìã Ë§áË£Ω</button>
                            <button class="action-btn suno-btn" onclick="window.open('https://suno.com/create','_blank')">üöÄ Suno</button>
                            <button class="action-btn export-btn" onclick="exportTrack(${i})">üíæ ÂåØÂá∫</button>
                            <button class="action-btn add-lib-btn" onclick="addTrackToLibrary(${i})">üìö Êî∂Ëóè</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleTrack(idx) {
            const track = document.getElementById(`track-${idx}`);
            track.classList.toggle('active');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function switchVersion(idx) {
            document.querySelectorAll('.version-tab').forEach((t, i) => t.classList.toggle('active', i === idx));
            document.querySelectorAll('.version-content').forEach((c, i) => c.classList.toggle('active', i === idx));
        }

        // ===== Ë§áË£Ω/ÂåØÂá∫ÂäüËÉΩ =====
        function copyText(encoded, btn) {
            navigator.clipboard.writeText(decodeURIComponent(encoded)).then(() => {
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Ë§áË£Ω!';
                setTimeout(() => btn.textContent = orig, 2000);
            });
        }

        function copyLyrics(idx) {
            const lyrics = generatedVersions[idx]?.lyrics || '';
            const btn = event.target;
            
            navigator.clipboard.writeText(lyrics).then(() => {
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Ë§áË£Ω!';
                setTimeout(() => btn.textContent = orig, 2000);
            });
        }

        function copyTrackLyrics(idx) {
            const lyrics = generatedAlbum?.tracks[idx]?.lyrics || '';
            const btn = event.target;
            
            navigator.clipboard.writeText(lyrics).then(() => {
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Ë§áË£Ω!';
                setTimeout(() => btn.textContent = orig, 2000);
            });
        }

        function exportVersion(idx) {
            const v = generatedVersions[idx];
            if (!v) return;
            const data = {
                theme: document.getElementById('theme').value,
                lyrics: v.lyrics.split('\n'),
                stylePrompt: v.stylePrompt,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `lyrics_v${idx + 1}_${Date.now()}.json`;
            link.click();
        }

        function exportTrack(idx) {
            const track = generatedAlbum?.tracks[idx];
            if (!track) return;
            const data = {
                albumName: generatedAlbum.name,
                trackNumber: idx + 1,
                title: track.title,
                lyrics: track.lyrics.split('\n'),
                stylePrompt: track.stylePrompt,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${track.title}_${Date.now()}.json`;
            link.click();
        }

        function importLyrics(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.theme) document.getElementById('theme').value = data.theme;
                    let lyrics = data.lyrics;
                    if (Array.isArray(lyrics)) lyrics = lyrics.join('\n');
                    generatedVersions = [{ lyrics, stylePrompt: data.stylePrompt || '' }];
                    generatedAlbum = null;
                    renderVersions(generatedVersions);
                    document.getElementById('resultSection').classList.add('show');
                    alert('‚úÖ ÂåØÂÖ•ÊàêÂäü!');
                } catch { alert('ÂåØÂÖ•Â§±Êïó'); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ===== Èö®Ê©üÈùàÊÑü =====
        function randomFill() {
            const themes = ['Â§±ÊàÄÁöÑÊ∑±Â§ú', 'ËøΩÂ§¢ÊóÖÁ®ã', 'Â§èÊó•Êµ∑ÈÇä', 'ÂüéÂ∏ÇÈúìËôπ', 'ÊòüÁ©∫ÂëäÁôΩ', 'Èõ®Â§©ÊÄùÂøµ', 'ÂçàÂ§úÁãÇÊ≠°', 'ÈÅ†ÊñπÊïÖÈÑâ', 'ÈáçÊñ∞ÈñãÂßã', 'ÁÑ°Áõ°Á≠âÂæÖ', 'ÈùíÊò•Ë®òÊÜ∂', 'ÂøÉÁ¢é‰πãÂæå', 'ÂãáÊï¢ÂâçË°å', 'Êµ™Êº´ÈÇÇÈÄÖ', 'Â≠§Áç®ÊóÖ‰∫∫'];
            document.getElementById('theme').value = themes[Math.floor(Math.random() * themes.length)];
            
            ['genre', 'mood', 'instruments'].forEach(type => {
                clearAll(type);
                const container = document.getElementById(`${type}Container`);
                const allCbs = Array.from(container.querySelectorAll('input[type="checkbox"]'));
                const shuffled = shuffleArray(allCbs);
                const count = type === 'instruments' ? Math.floor(Math.random() * 4) + 1 : Math.floor(Math.random() * 2) + 1;
                shuffled.slice(0, count).forEach(cb => cb.checked = true);
                updateMultiSelect(type);
            });
            
            const randomSelect = (id) => {
                const sel = document.getElementById(id);
                const opts = sel.options;
                sel.selectedIndex = Math.floor(Math.random() * opts.length);
            };
            
            ['bpm', 'era', 'key', 'region', 'production', 'vocalEffect'].forEach(randomSelect);
            
            saveFormState();
        }

        // ===== Ë©ûÂ∫´ÁÆ°ÁêÜ (IndexedDB) =====
        async function loadLibraryFromDB() {
            try {
                const data = await loadFromIndexedDB(LIBRARY_STORE, 'songs');
                savedSongs = data || [];
            } catch (e) {
                console.warn('Load library failed:', e);
                savedSongs = [];
            }
        }

        async function saveLibraryToDB() {
            try {
                await saveToIndexedDB(LIBRARY_STORE, 'songs', savedSongs);
            } catch (e) {
                console.warn('Save library failed:', e);
                throw e;
            }
        }

        async function addToLibrary(idx) {
            const v = generatedVersions[idx];
            if (!v || !v.lyrics.trim()) return alert('Ê≤íÊúâÂÖßÂÆπÂèØÊî∂Ëóè!');
            
            savedSongs.unshift({
                id: Date.now(),
                theme: document.getElementById('theme').value || 'Êú™ÂëΩÂêç',
                date: new Date().toLocaleString(),
                lyrics: v.lyrics,
                stylePrompt: v.stylePrompt
            });

            try {
                await saveLibraryToDB();
                renderLibrary();
                const btn = event.target;
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Êî∂Ëóè';
                setTimeout(() => btn.textContent = orig, 1500);
            } catch (e) {
                alert('ÂÑ≤Â≠òÂ§±Êïó: ' + e.message);
                savedSongs.shift();
            }
        }

        async function addTrackToLibrary(idx) {
            const track = generatedAlbum?.tracks[idx];
            if (!track || !track.lyrics.trim()) return alert('Ê≤íÊúâÂÖßÂÆπÂèØÊî∂Ëóè!');
            
            savedSongs.unshift({
                id: Date.now(),
                theme: `${generatedAlbum.name} - ${track.title}`,
                date: new Date().toLocaleString(),
                lyrics: track.lyrics,
                stylePrompt: track.stylePrompt
            });

            try {
                await saveLibraryToDB();
                renderLibrary();
                const btn = event.target;
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Êî∂Ëóè';
                setTimeout(() => btn.textContent = orig, 1500);
            } catch (e) {
                alert('ÂÑ≤Â≠òÂ§±Êïó: ' + e.message);
                savedSongs.shift();
            }
        }

        async function deleteFromLibrary(id) {
            if (!confirm('Á¢∫ÂÆöÂà™Èô§?')) return;
            savedSongs = savedSongs.filter(s => s.id !== id);
            await saveLibraryToDB();
            renderLibrary();
        }

        function loadFromLibrary(id) {
            const song = savedSongs.find(s => s.id === id);
            if (song) {
                document.getElementById('theme').value = song.theme;
                generatedVersions = [{ lyrics: song.lyrics, stylePrompt: song.stylePrompt || '' }];
                generatedAlbum = null;
                renderVersions(generatedVersions);
                document.getElementById('resultSection').classList.add('show');
                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function renderLibrary() {
            document.getElementById('libCount').textContent = savedSongs.length;
            const list = document.getElementById('libraryList');
            if (savedSongs.length === 0) {
                list.innerHTML = '<p style="text-align:center;color:var(--text-muted);padding:30px;">Ë©ûÂ∫´ÊòØÁ©∫ÁöÑ</p>';
                return;
            }
            list.innerHTML = savedSongs.map(s => `
                <div class="library-item">
                    <div class="lib-item-header">
                        <span>${escapeHtml(s.theme)}</span>
                        <span class="lib-item-date">${s.date}</span>
                    </div>
                    <div class="lib-preview">${escapeHtml(s.lyrics.substring(0, 80))}...</div>
                    <div class="lib-actions">
                        <button class="btn-load" onclick="loadFromLibrary(${s.id})">‚úèÔ∏è ËºâÂÖ•</button>
                        <button class="btn-delete" onclick="deleteFromLibrary(${s.id})">üóëÔ∏è Âà™Èô§</button>
                    </div>
                </div>
            `).join('');
        }

        function exportLibrary() {
            if (savedSongs.length === 0) return alert('Ë©ûÂ∫´ÊòØÁ©∫ÁöÑ');
            const blob = new Blob([JSON.stringify(savedSongs, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `lyrics_library_${Date.now()}.json`;
            link.click();
        }

        async function importLibrary(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (!Array.isArray(data)) throw new Error();
                    savedSongs = [...data, ...savedSongs];
                    await saveLibraryToDB();
                    renderLibrary();
                    alert(`ÊàêÂäüÂåØÂÖ• ${data.length} È¶ñ!`);
                } catch { alert('ÂåØÂÖ•Â§±Êïó'); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ===== Enter ÈçµÊîØÊè¥ =====
        document.getElementById('theme').addEventListener('keypress', e => { if (e.key === 'Enter') generateLyrics(); });
        document.getElementById('apiKeyInput').addEventListener('keypress', e => { if (e.key === 'Enter') saveApiKey(); });

        // ===== ÂàùÂßãÂåñ =====
        async function init() {
            await initIndexedDB();
            await loadFormState();
            await loadLibraryFromDB();
            renderLibrary();
        }

        init();
    </script>
</body>
</html>
