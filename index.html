<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ê≠åË©ûÁîüÊàêÂô® Pro | Suno Â∞àÁî®</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: rgba(20, 20, 30, 0.8);
            --bg-input: rgba(30, 30, 45, 0.6);
            --border-color: rgba(255, 255, 255, 0.08);
            --border-glow: rgba(0, 212, 255, 0.3);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-muted: rgba(255, 255, 255, 0.4);
            --accent-cyan: #00d4ff;
            --accent-magenta: #ff00aa;
            --accent-purple: #8b5cf6;
            --accent-orange: #ff6b35;
            --accent-green: #00ff88;
            --accent-yellow: #fbbf24;
            --gradient-main: linear-gradient(135deg, #00d4ff 0%, #8b5cf6 50%, #ff00aa 100%);
            --gradient-button: linear-gradient(135deg, #00d4ff 0%, #8b5cf6 100%);
            --gradient-warm: linear-gradient(135deg, #ff6b35 0%, #ff00aa 100%);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.1);
            --shadow-glow: 0 0 40px rgba(0, 212, 255, 0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .bg-gradient {
            position: fixed;
            inset: 0;
            z-index: -1;
            overflow: hidden;
        }

        .bg-gradient::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(ellipse 80% 50% at 20% 20%, rgba(0, 212, 255, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 80% 80%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse 50% 60% at 50% 50%, rgba(255, 0, 170, 0.08) 0%, transparent 50%);
            animation: bgFloat 20s ease-in-out infinite;
        }

        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(2%, 2%) rotate(1deg); }
            66% { transform: translate(-1%, 1%) rotate(-1deg); }
        }

        .grid-overlay {
            position: fixed;
            inset: 0;
            z-index: -1;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 50px 50px;
            mask-image: radial-gradient(ellipse 80% 60% at 50% 30%, black, transparent);
        }

        .app-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-icon {
            width: 70px;
            height: 70px;
            background: var(--gradient-main);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            box-shadow: 0 10px 40px rgba(0, 212, 255, 0.3);
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .logo-text { text-align: left; }

        .logo-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .logo-subtitle {
            font-size: 0.85em;
            color: var(--text-secondary);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .pro-badge {
            background: var(--gradient-warm);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: 700;
            letter-spacing: 1px;
            margin-left: 10px;
            vertical-align: middle;
        }

        .header-description {
            color: var(--text-secondary);
            font-size: 1em;
            max-width: 550px;
            margin: 0 auto;
        }

        /* Âç°ÁâáËàáÂçÄÂ°ä */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 30px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.5), transparent);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .card:hover::before { opacity: 1; }
        .card:hover {
            border-color: var(--border-glow);
            box-shadow: var(--shadow-glow);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-icon {
            width: 42px;
            height: 42px;
            background: var(--gradient-button);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .card-title {
            font-size: 1.2em;
            font-weight: 600;
        }

        /* ÂèØÊäòÁñäÂçÄÂ°ä */
        .collapsible-section {
            margin-bottom: 20px;
        }

        .section-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(0, 212, 255, 0.08);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s;
        }

        .section-toggle:hover {
            background: rgba(0, 212, 255, 0.12);
        }

        .section-toggle-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-toggle-icon {
            font-size: 1.3em;
        }

        .section-toggle-title {
            font-weight: 600;
            font-size: 1em;
        }

        .section-toggle-hint {
            font-size: 0.85em;
            color: var(--text-muted);
            margin-left: 10px;
        }

        .section-toggle-arrow {
            font-size: 1.2em;
            transition: transform 0.3s;
            color: var(--accent-cyan);
        }

        .section-toggle.open .section-toggle-arrow {
            transform: rotate(180deg);
        }

        .section-content {
            display: none;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            animation: slideDown 0.3s ease-out;
        }

        .section-content.open {
            display: block;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ë°®ÂñÆÊ®£Âºè */
        .form-group { margin-bottom: 20px; }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-weight: 500;
            font-size: 0.95em;
        }

        .label-hint {
            font-size: 0.8em;
            color: var(--text-muted);
            font-weight: 400;
        }

        .selection-count {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            padding: 2px 10px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: auto;
        }

        input[type="text"],
        input[type="password"],
        select,
        textarea {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.95em;
            font-family: inherit;
            transition: all 0.3s;
            outline: none;
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-muted);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.15);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2300d4ff' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 45px;
        }

        select option {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .form-row-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        @media (max-width: 900px) {
            .form-row-4 { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 640px) {
            .form-row, .form-row-3, .form-row-4 { grid-template-columns: 1fr; }
        }

        /* ÂñÆÈÅ∏ÊåâÈàïÁµÑ */
        .radio-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .radio-option {
            position: relative;
            cursor: pointer;
            flex: 1;
            min-width: 140px;
        }

        .radio-option input {
            position: absolute;
            opacity: 0;
        }

        .radio-option .radio-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            transition: all 0.3s;
            font-size: 0.9em;
            text-align: center;
        }

        .radio-option input:checked + .radio-label {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
            border-color: var(--accent-cyan);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.2);
        }

        .radio-option:hover .radio-label {
            border-color: rgba(0, 212, 255, 0.5);
        }

        /* Â§öÈÅ∏‰∏ãÊãâÈÅ∏ÂñÆ */
        .multi-select-container { position: relative; }

        .multi-select-display {
            width: 100%;
            min-height: 52px;
            padding: 10px 14px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .multi-select-display:hover {
            border-color: rgba(0, 212, 255, 0.5);
        }

        .multi-select-display.active {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.15);
        }

        .selected-items {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        .selected-tag {
            background: var(--gradient-button);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            animation: tagPop 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes tagPop {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .selected-tag .remove-tag {
            cursor: pointer;
            opacity: 0.8;
            font-size: 1em;
            transition: all 0.2s;
        }

        .selected-tag .remove-tag:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .multi-select-placeholder {
            color: var(--text-muted);
            font-size: 0.9em;
        }

        .multi-select-arrow {
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid var(--accent-cyan);
            transition: transform 0.3s;
        }

        .multi-select-arrow.open {
            transform: rotate(180deg);
        }

        .multi-select-dropdown {
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-glow);
            border-radius: var(--radius-md);
            max-height: 350px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .multi-select-dropdown.show {
            display: block;
            animation: dropdownReveal 0.3s ease-out;
        }

        @keyframes dropdownReveal {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .dropdown-group {
            border-bottom: 1px solid var(--border-color);
        }

        .dropdown-group:last-child {
            border-bottom: none;
        }

        .dropdown-group-label {
            padding: 12px 15px;
            background: rgba(0, 212, 255, 0.05);
            font-weight: 600;
            color: var(--accent-cyan);
            font-size: 0.85em;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .dropdown-option {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
            font-size: 0.9em;
        }

        .dropdown-option:hover {
            background: rgba(0, 212, 255, 0.08);
        }

        .dropdown-option.selected {
            background: rgba(0, 212, 255, 0.12);
        }

        .dropdown-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--accent-cyan);
        }

        .dropdown-option label {
            flex: 1;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .dropdown-option:hover label {
            color: var(--text-primary);
        }

        .dropdown-actions {
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            gap: 10px;
            position: sticky;
            bottom: 0;
        }

        .dropdown-actions button {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.8em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .dropdown-actions button:hover {
            background: rgba(255, 255, 255, 0.15);
            color: var(--text-primary);
        }

        select[multiple] { display: none !important; }

        /* ÊªæÂãïÊ¢ù */
        .multi-select-dropdown::-webkit-scrollbar,
        .lyrics-output::-webkit-scrollbar {
            width: 6px;
        }

        .multi-select-dropdown::-webkit-scrollbar-track,
        .lyrics-output::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .multi-select-dropdown::-webkit-scrollbar-thumb,
        .lyrics-output::-webkit-scrollbar-thumb {
            background: var(--accent-cyan);
            border-radius: 3px;
        }

        /* ÊåâÈàï */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 14px 28px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 1em;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .btn:hover::before { opacity: 1; }

        .btn-primary {
            background: var(--gradient-button);
            color: white;
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 212, 255, 0.35);
        }

        .btn-secondary {
            background: var(--gradient-warm);
            color: white;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.25);
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 107, 53, 0.35);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 640px) {
            .btn-group { grid-template-columns: 1fr; }
        }

        /* ÁµêÊûúÂçÄÂüü */
        .result-section { display: none; }

        .result-section.show {
            display: block;
            animation: resultReveal 0.6s ease-out;
        }

        @keyframes resultReveal {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .version-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .version-tab {
            padding: 10px 24px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .version-tab:hover {
            border-color: rgba(0, 212, 255, 0.5);
            color: var(--text-primary);
        }

        .version-tab.active {
            background: var(--gradient-button);
            border-color: transparent;
            color: white;
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.3);
        }

        .version-content { display: none; }

        .version-content.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .style-prompt-section {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.15) 0%, rgba(255, 0, 170, 0.15) 100%);
            border: 1px solid rgba(255, 107, 53, 0.3);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }

        .style-prompt-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--accent-orange);
        }

        .style-prompt-output {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            line-height: 1.7;
            font-size: 0.9em;
            margin-bottom: 12px;
            min-height: 50px;
        }

        .lyrics-output {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: var(--radius-lg);
            padding: 25px;
            font-family: 'JetBrains Mono', 'Noto Sans TC', monospace;
            font-size: 0.9em;
            line-height: 1.9;
            color: var(--text-primary);
            max-height: 450px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            position: relative;
        }

        .lyrics-output::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient-main);
            border-radius: 4px 0 0 4px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        @media (max-width: 640px) {
            .action-buttons { grid-template-columns: repeat(2, 1fr); }
        }

        .action-btn {
            padding: 12px 16px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 0.85em;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .copy-btn {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: var(--bg-primary);
        }

        .suno-btn {
            background: linear-gradient(135deg, #ff6b35 0%, #ff4444 100%);
            color: white;
        }

        .export-btn {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
        }

        .add-lib-btn {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: var(--bg-primary);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .copy-style-prompt-btn {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: var(--radius-sm);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
        }

        .copy-style-prompt-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .loading.show { display: block; }

        .spinner {
            width: 50px;
            height: 50px;
            margin: 0 auto 15px;
            position: relative;
        }

        .spinner::before,
        .spinner::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            border: 3px solid transparent;
        }

        .spinner::before {
            border-top-color: var(--accent-cyan);
            animation: spin 1s linear infinite;
        }

        .spinner::after {
            border-bottom-color: var(--accent-magenta);
            animation: spin 1s linear infinite reverse;
            inset: 6px;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .loading-text {
            color: var(--text-secondary);
            font-size: 1em;
        }

        /* Ë©ûÂ∫´ÂçÄÂüü */
        .library-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
        }

        .library-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }

        .library-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .library-count {
            background: var(--gradient-button);
            color: white;
            padding: 3px 12px;
            border-radius: 20px;
            font-size: 0.5em;
            font-weight: 600;
        }

        .global-actions {
            display: flex;
            gap: 10px;
        }

        .global-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.85em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .import-btn {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
        }

        .library-list {
            display: grid;
            gap: 12px;
        }

        .library-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 18px;
            transition: all 0.3s;
        }

        .library-item:hover {
            border-color: var(--border-glow);
            transform: translateY(-2px);
        }

        .lib-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .lib-item-header span:first-child {
            font-weight: 600;
            font-size: 1em;
        }

        .lib-item-date {
            font-size: 0.8em;
            color: var(--text-muted);
        }

        .lib-preview {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: var(--radius-sm);
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-bottom: 12px;
            max-height: 60px;
            overflow: hidden;
        }

        .lib-actions {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }

        .lib-actions button {
            padding: 6px 14px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.8em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-load {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-delete {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        /* ÊèêÁ§∫ÂçÄ */
        .tips-card {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(217, 119, 6, 0.1) 100%);
            border: 1px solid rgba(245, 158, 11, 0.2);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-top: 25px;
        }

        .tips-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            color: #f59e0b;
            font-weight: 600;
        }

        .tips-list {
            list-style: none;
            padding: 0;
        }

        .tips-list li {
            padding: 6px 0 6px 22px;
            position: relative;
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .tips-list li::before {
            content: '‚ú¶';
            position: absolute;
            left: 0;
            color: #f59e0b;
        }

        /* Ë®≠ÂÆöÊåâÈàï */
        .settings-btn {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: var(--gradient-button);
            color: white;
            border: none;
            font-size: 1.4em;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.4);
            transition: all 0.3s;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }

        /* Ê®°ÊÖãË¶ñÁ™ó */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 2000;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.show {
            display: flex;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 30px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-50px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 1.4em;
            margin-bottom: 8px;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .modal-header p {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .info-box {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .info-box p {
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .info-box a {
            color: var(--accent-cyan);
            text-decoration: none;
        }

        .info-box a:hover {
            text-decoration: underline;
        }

        .modal-body { margin-bottom: 20px; }

        .modal-footer {
            display: flex;
            gap: 10px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn-primary {
            background: var(--gradient-button);
            color: white;
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
        }

        .modal-btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .modal-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* ÈüøÊáâÂºè */
        @media (max-width: 768px) {
            .app-container { padding: 20px 15px; }
            .header { margin-bottom: 25px; }
            .logo { flex-direction: column; text-align: center; }
            .logo-text { text-align: center; }
            .logo-title { font-size: 1.8em; }
            .card { padding: 20px; }
            .settings-btn { width: 48px; height: 48px; bottom: 15px; right: 15px; font-size: 1.2em; }
            .radio-option { min-width: 100%; }
        }

        .footer {
            text-align: center;
            padding: 30px 20px;
            color: var(--text-muted);
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>
    <div class="grid-overlay"></div>

    <div class="app-container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üéµ</div>
                <div class="logo-text">
                    <h1 class="logo-title">AI LYRICS <span class="pro-badge">PRO</span></h1>
                    <p class="logo-subtitle">Suno AI Â∞àÊ•≠Ê≠åË©ûÁîüÊàêÂô®</p>
                </div>
            </div>
            <p class="header-description">ÂÆåÊï¥Èü≥Ê®ÇÂèÉÊï∏Ë®≠ÂÆöÔºåÊâìÈÄ†Áç®‰∏ÄÁÑ°‰∫åÁöÑÂ∞àÂ±¨Ê≠åÊõ≤</p>
        </header>

        <!-- Âü∫Êú¨Ë®≠ÂÆöÂç°Áâá -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üéØ</div>
                <h2 class="card-title">Âü∫Êú¨Ë®≠ÂÆö</h2>
            </div>

            <div class="form-group">
                <label class="form-label">‚ú® Ê≠åÊõ≤‰∏ªÈ°å <span class="label-hint">ÔºàÂøÖÂ°´Ôºâ</span></label>
                <input type="text" id="theme" placeholder="‰æãÂ¶ÇÔºöÂ§±ÊàÄÁöÑÊ∑±Â§ú„ÄÅËøΩÂ§¢ÁöÑÊóÖÁ®ã„ÄÅÂüéÂ∏ÇÈúìËôπ...">
            </div>

            <div class="form-group">
                <label class="form-label">üé§ Ê≠åÊõ≤È°ûÂûã</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="songType" value="vocal" checked>
                        <span class="radio-label">üéôÔ∏è ÊúâÊ≠åË©û</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="songType" value="instrumental">
                        <span class="radio-label">üéπ Á¥îÈü≥Ê®Ç</span>
                    </label>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">üéº Èü≥Ê®ÇÈ¢®Ê†º <span class="selection-count" id="genreCount"></span></label>
                    <div class="multi-select-container" id="genreContainer">
                        <div class="multi-select-display" onclick="toggleDropdown('genre')">
                            <div class="selected-items" id="genreSelected">
                                <span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>
                            </div>
                            <div class="multi-select-arrow" id="genreArrow"></div>
                        </div>
                        <div class="multi-select-dropdown" id="genreDropdown">
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé§ ÊµÅË°å</div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Pop" value="Pop" onchange="updateMultiSelect('genre')"><label for="g_Pop">Pop ÊµÅË°å</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_SynthPop" value="Synth Pop" onchange="updateMultiSelect('genre')"><label for="g_SynthPop">Synth Pop ÈõªÂ≠êÊµÅË°å</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_DancePop" value="Dance Pop" onchange="updateMultiSelect('genre')"><label for="g_DancePop">Dance Pop ËàûÊõ≤ÊµÅË°å</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_PopBallad" value="Pop Ballad" onchange="updateMultiSelect('genre')"><label for="g_PopBallad">Pop Ballad ÊäíÊÉÖÊµÅË°å</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_KPop" value="K-Pop" onchange="updateMultiSelect('genre')"><label for="g_KPop">K-Pop ÈüìÊµÅ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_JPop" value="J-Pop" onchange="updateMultiSelect('genre')"><label for="g_JPop">J-Pop Êó•ÊµÅ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Mandopop" value="Mandopop" onchange="updateMultiSelect('genre')"><label for="g_Mandopop">Mandopop ËèØË™ûÊµÅË°å</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé∏ ÊêñÊªæ</div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Rock" value="Rock" onchange="updateMultiSelect('genre')"><label for="g_Rock">Rock ÊêñÊªæ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_PopRock" value="Pop Rock" onchange="updateMultiSelect('genre')"><label for="g_PopRock">Pop Rock ÊµÅË°åÊêñÊªæ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Alternative" value="Alternative" onchange="updateMultiSelect('genre')"><label for="g_Alternative">Alternative Âè¶È°ûÊêñÊªæ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Indie" value="Indie Rock" onchange="updateMultiSelect('genre')"><label for="g_Indie">Indie Rock Áç®Á´ãÊêñÊªæ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Punk" value="Punk" onchange="updateMultiSelect('genre')"><label for="g_Punk">Punk ÈæêÂÖã</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Metal" value="Metal" onchange="updateMultiSelect('genre')"><label for="g_Metal">Metal ÈáëÂ±¨</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Grunge" value="Grunge" onchange="updateMultiSelect('genre')"><label for="g_Grunge">Grunge Ê≤πÊº¨ÊêñÊªæ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_PostRock" value="Post Rock" onchange="updateMultiSelect('genre')"><label for="g_PostRock">Post Rock ÂæåÊêñÊªæ</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üé§ ÂòªÂìà/R&B</div>
                                <div class="dropdown-option"><input type="checkbox" id="g_HipHop" value="Hip Hop" onchange="updateMultiSelect('genre')"><label for="g_HipHop">Hip Hop ÂòªÂìà</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Trap" value="Trap" onchange="updateMultiSelect('genre')"><label for="g_Trap">Trap Èô∑Èò±Èü≥Ê®Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_RnB" value="R&B" onchange="updateMultiSelect('genre')"><label for="g_RnB">R&B ÁØÄÂ•èËóçË™ø</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Soul" value="Soul" onchange="updateMultiSelect('genre')"><label for="g_Soul">Soul ÈùàÈ≠ÇÊ®Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_NeoSoul" value="Neo Soul" onchange="updateMultiSelect('genre')"><label for="g_NeoSoul">Neo Soul Êñ∞ÈùàÈ≠Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Funk" value="Funk" onchange="updateMultiSelect('genre')"><label for="g_Funk">Funk ÊîæÂÖã</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üéõÔ∏è ÈõªÂ≠ê</div>
                                <div class="dropdown-option"><input type="checkbox" id="g_EDM" value="EDM" onchange="updateMultiSelect('genre')"><label for="g_EDM">EDM ÈõªÂ≠êËàûÊõ≤</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_House" value="House" onchange="updateMultiSelect('genre')"><label for="g_House">House Êµ©ÂÆ§</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Techno" value="Techno" onchange="updateMultiSelect('genre')"><label for="g_Techno">Techno ÈêµÂÖãË´æ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Trance" value="Trance" onchange="updateMultiSelect('genre')"><label for="g_Trance">Trance Âá∫Á•û</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Dubstep" value="Dubstep" onchange="updateMultiSelect('genre')"><label for="g_Dubstep">Dubstep Ëø¥ÈüøË≤ùÊñØ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_DnB" value="Drum and Bass" onchange="updateMultiSelect('genre')"><label for="g_DnB">Drum & Bass ÈºìÊâìË≤ùÊñØ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_FutureBass" value="Future Bass" onchange="updateMultiSelect('genre')"><label for="g_FutureBass">Future Bass Êú™‰æÜË≤ùÊñØ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Synthwave" value="Synthwave" onchange="updateMultiSelect('genre')"><label for="g_Synthwave">Synthwave ÂêàÊàêÂô®Êµ™ÊΩÆ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Ambient" value="Ambient" onchange="updateMultiSelect('genre')"><label for="g_Ambient">Ambient Ê∞õÂúç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Lofi" value="Lo-fi" onchange="updateMultiSelect('genre')"><label for="g_Lofi">Lo-fi ‰Ωé‰øùÁúü</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Chillwave" value="Chillwave" onchange="updateMultiSelect('genre')"><label for="g_Chillwave">Chillwave ÊÖµÊá∂ÈõªÂ≠ê</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üéª Ê∞ëË¨†/Âè§ÂÖ∏/ÁàµÂ£´</div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Folk" value="Folk" onchange="updateMultiSelect('genre')"><label for="g_Folk">Folk Ê∞ëË¨†</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Country" value="Country" onchange="updateMultiSelect('genre')"><label for="g_Country">Country ÈÑâÊùë</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Acoustic" value="Acoustic" onchange="updateMultiSelect('genre')"><label for="g_Acoustic">Acoustic ÂéüËÅ≤</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Classical" value="Classical" onchange="updateMultiSelect('genre')"><label for="g_Classical">Classical Âè§ÂÖ∏</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Jazz" value="Jazz" onchange="updateMultiSelect('genre')"><label for="g_Jazz">Jazz ÁàµÂ£´</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Blues" value="Blues" onchange="updateMultiSelect('genre')"><label for="g_Blues">Blues ËóçË™ø</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_BossaNova" value="Bossa Nova" onchange="updateMultiSelect('genre')"><label for="g_BossaNova">Bossa Nova Â∑¥Ëñ©Ë´æÁì¶</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üåç ‰∏ñÁïå/ÂÖ∂‰ªñ</div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Latin" value="Latin" onchange="updateMultiSelect('genre')"><label for="g_Latin">Latin Êãâ‰∏Å</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Reggae" value="Reggae" onchange="updateMultiSelect('genre')"><label for="g_Reggae">Reggae Èõ∑È¨º</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Reggaeton" value="Reggaeton" onchange="updateMultiSelect('genre')"><label for="g_Reggaeton">Reggaeton Èõ∑È¨ºÂãï</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Gospel" value="Gospel" onchange="updateMultiSelect('genre')"><label for="g_Gospel">Gospel Á¶èÈü≥</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Celtic" value="Celtic" onchange="updateMultiSelect('genre')"><label for="g_Celtic">Celtic Âá±ÁàæÁâπ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Cinematic" value="Cinematic" onchange="updateMultiSelect('genre')"><label for="g_Cinematic">Cinematic ÈõªÂΩ±ÈÖçÊ®Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_GameOST" value="Game OST" onchange="updateMultiSelect('genre')"><label for="g_GameOST">Game OST ÈÅäÊà≤ÈÖçÊ®Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="g_Anime" value="Anime" onchange="updateMultiSelect('genre')"><label for="g_Anime">Anime ÂãïÊº´</label></div>
                            </div>
                            <div class="dropdown-actions">
                                <button type="button" onclick="clearAll('genre')">Ê∏ÖÈô§ÂÖ®ÈÉ®</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">üí´ ÊÉÖÊÑüÂü∫Ë™ø <span class="selection-count" id="moodCount"></span></label>
                    <div class="multi-select-container" id="moodContainer">
                        <div class="multi-select-display" onclick="toggleDropdown('mood')">
                            <div class="selected-items" id="moodSelected">
                                <span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>
                            </div>
                            <div class="multi-select-arrow" id="moodArrow"></div>
                        </div>
                        <div class="multi-select-dropdown" id="moodDropdown">
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üòÑ Ê≠£Âêë/Ê¥ªÂäõ</div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Happy" value="Happy" onchange="updateMultiSelect('mood')"><label for="m_Happy">Happy Âø´Ê®Ç</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Uplifting" value="Uplifting" onchange="updateMultiSelect('mood')"><label for="m_Uplifting">Uplifting ÊåØÂ•Æ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Energetic" value="Energetic" onchange="updateMultiSelect('mood')"><label for="m_Energetic">Energetic Ê¥ªÂäõ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Euphoric" value="Euphoric" onchange="updateMultiSelect('mood')"><label for="m_Euphoric">Euphoric ÁãÇÂñú</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Hopeful" value="Hopeful" onchange="updateMultiSelect('mood')"><label for="m_Hopeful">Hopeful Â∏åÊúõ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Playful" value="Playful" onchange="updateMultiSelect('mood')"><label for="m_Playful">Playful ‰øèÁöÆ</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">‚ù§Ô∏è Êµ™Êº´/Ê∑±ÊÉÖ</div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Romantic" value="Romantic" onchange="updateMultiSelect('mood')"><label for="m_Romantic">Romantic Êµ™Êº´</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Passionate" value="Passionate" onchange="updateMultiSelect('mood')"><label for="m_Passionate">Passionate ÁÜ±ÊÉÖ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Tender" value="Tender" onchange="updateMultiSelect('mood')"><label for="m_Tender">Tender Ê∫´Êüî</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Longing" value="Longing" onchange="updateMultiSelect('mood')"><label for="m_Longing">Longing Ê∏¥Êúõ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Sensual" value="Sensual" onchange="updateMultiSelect('mood')"><label for="m_Sensual">Sensual ÊÑüÊÄß</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üò¢ ÊÜÇÂÇ∑/Ê≤âÈáç</div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Sad" value="Sad" onchange="updateMultiSelect('mood')"><label for="m_Sad">Sad ÊÇ≤ÂÇ∑</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Melancholic" value="Melancholic" onchange="updateMultiSelect('mood')"><label for="m_Melancholic">Melancholic ÊÜÇÈ¨±</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Heartbroken" value="Heartbroken" onchange="updateMultiSelect('mood')"><label for="m_Heartbroken">Heartbroken ÂøÉÁ¢é</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Nostalgic" value="Nostalgic" onchange="updateMultiSelect('mood')"><label for="m_Nostalgic">Nostalgic Êá∑Ëàä</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Bittersweet" value="Bittersweet" onchange="updateMultiSelect('mood')"><label for="m_Bittersweet">Bittersweet Ëã¶Ê®ÇÂèÉÂçä</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Lonely" value="Lonely" onchange="updateMultiSelect('mood')"><label for="m_Lonely">Lonely Â≠§Áç®</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üò† Âº∑ÁÉà/ÊøÄÊòÇ</div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Angry" value="Angry" onchange="updateMultiSelect('mood')"><label for="m_Angry">Angry ÊÜ§ÊÄí</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Aggressive" value="Aggressive" onchange="updateMultiSelect('mood')"><label for="m_Aggressive">Aggressive ÊøÄÈÄ≤</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Rebellious" value="Rebellious" onchange="updateMultiSelect('mood')"><label for="m_Rebellious">Rebellious ÂèõÈÄÜ</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Intense" value="Intense" onchange="updateMultiSelect('mood')"><label for="m_Intense">Intense Âº∑ÁÉà</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Epic" value="Epic" onchange="updateMultiSelect('mood')"><label for="m_Epic">Epic Âè≤Ë©©</label></div>
                            </div>
                            <div class="dropdown-group">
                                <div class="dropdown-group-label">üåô Âπ≥Èùú/Á•ûÁßò</div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Calm" value="Calm" onchange="updateMultiSelect('mood')"><label for="m_Calm">Calm Âπ≥Èùú</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Peaceful" value="Peaceful" onchange="updateMultiSelect('mood')"><label for="m_Peaceful">Peaceful Á••Âíå</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Dreamy" value="Dreamy" onchange="updateMultiSelect('mood')"><label for="m_Dreamy">Dreamy Â§¢Âπª</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Mysterious" value="Mysterious" onchange="updateMultiSelect('mood')"><label for="m_Mysterious">Mysterious Á•ûÁßò</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Dark" value="Dark" onchange="updateMultiSelect('mood')"><label for="m_Dark">Dark ÈªëÊöó</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Ethereal" value="Ethereal" onchange="updateMultiSelect('mood')"><label for="m_Ethereal">Ethereal Á©∫Èùà</label></div>
                                <div class="dropdown-option"><input type="checkbox" id="m_Chill" value="Chill" onchange="updateMultiSelect('mood')"><label for="m_Chill">Chill ÊÖµÊá∂</label></div>
                            </div>
                            <div class="dropdown-actions">
                                <button type="button" onclick="clearAll('mood')">Ê∏ÖÈô§ÂÖ®ÈÉ®</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÈÄ≤ÈöéË®≠ÂÆö (ÂèØÊäòÁñä) -->
        <div class="card">
            <div class="collapsible-section">
                <div class="section-toggle" onclick="toggleSection('advanced')">
                    <div class="section-toggle-left">
                        <span class="section-toggle-icon">üéõÔ∏è</span>
                        <span class="section-toggle-title">ÈÄ≤ÈöéÈü≥Ê®ÇË®≠ÂÆö</span>
                        <span class="section-toggle-hint">ÁØÄÂ•è„ÄÅÂπ¥‰ª£„ÄÅË™øÊÄß„ÄÅ‰∫∫ËÅ≤ÊïàÊûú...</span>
                    </div>
                    <span class="section-toggle-arrow" id="advancedArrowIcon">‚ñº</span>
                </div>
                <div class="section-content" id="advancedSection">
                    <div class="form-row-4">
                        <div class="form-group">
                            <label class="form-label">‚è±Ô∏è ÁØÄÂ•è BPM</label>
                            <select id="bpm">
                                <option value="">Ëá™Âãï</option>
                                <option value="Slow tempo, 60-70 BPM">Ê•µÊÖ¢ 60-70</option>
                                <option value="Slow, 70-90 BPM">ÊÖ¢Êùø 70-90</option>
                                <option value="Medium tempo, 90-120 BPM">‰∏≠Êùø 90-120</option>
                                <option value="Upbeat, 120-140 BPM">Âø´Êùø 120-140</option>
                                <option value="Fast, 140-160 BPM">Ê•µÂø´ 140-160</option>
                                <option value="Very fast, 160-180 BPM">ÁãÇÈ£Ü 160-180</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üìÖ Âπ¥‰ª£È¢®Ê†º</label>
                            <select id="era">
                                <option value="">Ëá™Âãï</option>
                                <option value="50s Retro">50s Âæ©Âè§</option>
                                <option value="60s Psychedelic">60s Ëø∑Âπª</option>
                                <option value="70s Disco">70s Disco</option>
                                <option value="80s Synth">80s ÂêàÊàêÂô®</option>
                                <option value="90s Grunge">90s Grunge</option>
                                <option value="2000s Y2K">2000s Y2K</option>
                                <option value="2010s EDM">2010s EDM</option>
                                <option value="Modern, Contemporary">Áèæ‰ª£Áï∂‰ª£</option>
                                <option value="Futuristic">Êú™‰æÜÊÑü</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üéµ Ë™øÊÄß</label>
                            <select id="key">
                                <option value="">Ëá™Âãï</option>
                                <option value="Major key, bright">Â§ßË™ø (Êòé‰∫Æ)</option>
                                <option value="Minor key, melancholic">Â∞èË™ø (ÊÜÇÈ¨±)</option>
                                <option value="Blues scale">ËóçË™øÈü≥Èöé</option>
                                <option value="Pentatonic scale, Eastern">‰∫îËÅ≤Èü≥Èöé (Êù±Êñπ)</option>
                                <option value="Phrygian mode, Spanish">ÂºóÈáåÂêâ‰∫û (Ë•øÁè≠Áâô)</option>
                                <option value="Dorian mode">Â§öÂà©ÂÆâË™øÂºè</option>
                                <option value="Mixolydian mode">Ê∑∑ÂêàÂà©Â∫ï‰∫û</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üåç Âú∞ÂüüÈ¢®Ê†º</label>
                            <select id="region">
                                <option value="">Ëá™Âãï</option>
                                <option value="American, Nashville">ÁæéÂºè Nashville</option>
                                <option value="British, UK">Ëã±ÂÄ´ UK</option>
                                <option value="Japanese style">Êó•Á≥ª</option>
                                <option value="Korean style">ÈüìÁ≥ª</option>
                                <option value="Latin flavor">Êãâ‰∏Å</option>
                                <option value="African rhythm">ÈùûÊ¥≤ÁØÄÂ•è</option>
                                <option value="Middle Eastern">‰∏≠Êù±Áï∞Âüü</option>
                                <option value="Nordic, Scandinavian">ÂåóÊ≠êÂÜ∑ÂÜΩ</option>
                                <option value="Chinese traditional">‰∏≠ËèØÂÇ≥Áµ±</option>
                                <option value="Taiwanese style">Âè∞ÂºèÈ¢®Ê†º</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label class="form-label">üéöÔ∏è Ë£Ω‰ΩúË≥™ÊÑü</label>
                            <select id="production">
                                <option value="">Ëá™Âãï</option>
                                <option value="Lo-fi, raw">Lo-fi ‰Ωé‰øùÁúü</option>
                                <option value="Hi-fi, polished">Hi-fi Á≤æÁ∑ª</option>
                                <option value="Vintage, vinyl">Âæ©Âè§ÈªëËÜ†</option>
                                <option value="Cassette tape">Á£ÅÂ∏∂Ë≥™ÊÑü</option>
                                <option value="Live band feel">ÁèæÂ†¥ Live ÊÑü</option>
                                <option value="Studio quality">ÈåÑÈü≥ÂÆ§Á≤æÁ∑ª</option>
                                <option value="Underground, raw">Âú∞‰∏ãÁ≤óÁç∑</option>
                                <option value="Overdriven, distorted">ÈÅéËºâÂ§±Áúü</label></div>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üéº Ê≠åÊõ≤ÁµêÊßã</label>
                            <select id="structure">
                                <option value="">Ê®ôÊ∫ñÁµêÊßã</option>
                                <option value="Standard verse-chorus">Ê®ôÊ∫ñ‰∏ªÂâØÊ≠å</option>
                                <option value="EDM build-drop structure">EDM Build-Drop</option>
                                <option value="Progressive, building">Êº∏ÈÄ≤Â†ÜÁñä</option>
                                <option value="Minimalist, loop-based">Âæ™Áí∞Ê•µÁ∞°</option>
                                <option value="Through-composed, free form">Ëá™Áî±Âç≥Ëàà</option>
                                <option value="Extended outro">Âä†Èï∑Â∞æÂ•è</option>
                                <option value="Intro heavy">ÈáçÂâçÂ•è</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">‚ú® ÁâπÊÆäÊäÄÊ≥ï</label>
                            <select id="technique">
                                <option value="">ÁÑ°</option>
                                <option value="Key change, modulation">ËΩâË™ø</option>
                                <option value="Tempo change">ËÆäÈÄü</option>
                                <option value="Fake ending">ÂÅáÁµêÂ∞æ</option>
                                <option value="Ambient sounds, field recording">Áí∞Â¢ÉÈü≥Êïà</option>
                                <option value="Reverse effects">ÂÄíÊîæÊïàÊûú</option>
                                <option value="Fade in fade out">Êº∏ÂÖ•Êº∏Âá∫</option>
                                <option value="A cappella section">Ê∏ÖÂî±ÊÆµËêΩ</option>
                                <option value="Breakdown section">Â¥©Ëß£ÊÆµËêΩ</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‰∫∫ËÅ≤Ë®≠ÂÆö -->
            <div class="collapsible-section">
                <div class="section-toggle" onclick="toggleSection('vocal')">
                    <div class="section-toggle-left">
                        <span class="section-toggle-icon">üé§</span>
                        <span class="section-toggle-title">‰∫∫ËÅ≤Ë®≠ÂÆö</span>
                        <span class="section-toggle-hint">ËÅ≤Á∑ö„ÄÅÊäÄÂ∑ß„ÄÅË™ûË®Ä...</span>
                    </div>
                    <span class="section-toggle-arrow" id="vocalArrowIcon">‚ñº</span>
                </div>
                <div class="section-content" id="vocalSection">
                    <div class="form-row-4">
                        <div class="form-group">
                            <label class="form-label">üéôÔ∏è ÊºîÂî±ËÅ≤Á∑ö</label>
                            <select id="voice">
                                <option value="Male vocal">Áî∑ËÅ≤</option>
                                <option value="Female vocal">Â•≥ËÅ≤</option>
                                <option value="Mixed vocals, duet">Áî∑Â•≥Â∞çÂî±</option>
                                <option value="Choir, group vocals">ÂêàÂî±Âúò</option>
                                <option value="Child voice">Á´•ËÅ≤</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üåè Ê≠åË©ûË™ûË®Ä</label>
                            <select id="language">
                                <option value="Chinese lyrics">‰∏≠Êñá</option>
                                <option value="English lyrics">Ëã±Êñá</option>
                                <option value="Japanese lyrics">Êó•Êñá</option>
                                <option value="Korean lyrics">ÈüìÊñá</option>
                                <option value="Chinese and English mixed">‰∏≠Ëã±Ê∑∑Âêà</option>
                                <option value="Spanish lyrics">Ë•øÁè≠ÁâôÊñá</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üéµ ‰∫∫ËÅ≤ÊïàÊûú</label>
                            <select id="vocalEffect">
                                <option value="">Ëá™ÁÑ∂</option>
                                <option value="Auto-tune, pitch corrected">Auto-tune</option>
                                <option value="Vocoder, robotic">Vocoder Ê©üÂô®‰∫∫</option>
                                <option value="Breathy, airy">Ê∞£Èü≥/ÂÅáÈü≥</option>
                                <option value="Raspy, gritty">Ê≤ôÂïûÁ≤óÁç∑</option>
                                <option value="Falsetto">ÂÅáËÅ≤</option>
                                <option value="Whisper">ËÄ≥Ë™û</option>
                                <option value="Layered harmonies">Â§öÂ±§ÂíåËÅ≤</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üìù Ê≠åË©ûÈ¢®Ê†º</label>
                            <select id="lyricStyle">
                                <option value="">Ëá™Âãï</option>
                                <option value="Narrative, storytelling">Êïò‰∫ãÊïÖ‰∫ã</option>
                                <option value="Metaphorical, symbolic">Èö±ÂñªË±°Âæµ</option>
                                <option value="Poetic, abstract">Ë©©ÊÑèÊäΩË±°</option>
                                <option value="Conversational, casual">Âè£Ë™ûÂ∞çË©±</option>
                                <option value="Stream of consciousness">ÊÑèË≠òÊµÅ</option>
                                <option value="Rap flow, rhythmic">È•íËàåÁØÄÂ•è</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ê®ÇÂô®ÈÖçÁΩÆ -->
            <div class="collapsible-section">
                <div class="section-toggle" onclick="toggleSection('instruments')">
                    <div class="section-toggle-left">
                        <span class="section-toggle-icon">üéπ</span>
                        <span class="section-toggle-title">Ê®ÇÂô®ÈÖçÁΩÆ</span>
                        <span class="section-toggle-hint" id="instrumentsCount"></span>
                    </div>
                    <span class="section-toggle-arrow" id="instrumentsArrowIcon">‚ñº</span>
                </div>
                <div class="section-content" id="instrumentsSection">
                    <div class="form-group">
                        <div class="multi-select-container" id="instrumentsContainer">
                            <div class="multi-select-display" onclick="toggleDropdown('instruments')">
                                <div class="selected-items" id="instrumentsSelected">
                                    <span class="multi-select-placeholder">ÈªûÊìäÈÅ∏ÊìáÊ®ÇÂô®...</span>
                                </div>
                                <div class="multi-select-arrow" id="instrumentsArrow"></div>
                            </div>
                            <div class="multi-select-dropdown" id="instrumentsDropdown">
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üéπ ÈçµÁõ§</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Piano" value="Piano" onchange="updateMultiSelect('instruments')"><label for="i_Piano">Piano ÈãºÁê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_ElectricPiano" value="Electric Piano" onchange="updateMultiSelect('instruments')"><label for="i_ElectricPiano">Electric Piano ÈõªÈãºÁê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Organ" value="Organ" onchange="updateMultiSelect('instruments')"><label for="i_Organ">Organ È¢®Áê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Synth" value="Synthesizer" onchange="updateMultiSelect('instruments')"><label for="i_Synth">Synthesizer ÂêàÊàêÂô®</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Accordion" value="Accordion" onchange="updateMultiSelect('instruments')"><label for="i_Accordion">Accordion ÊâãÈ¢®Áê¥</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé∏ Âêâ‰ªñ</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_AcousticGuitar" value="Acoustic Guitar" onchange="updateMultiSelect('instruments')"><label for="i_AcousticGuitar">Acoustic Guitar Êú®Âêâ‰ªñ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_ElectricGuitar" value="Electric Guitar" onchange="updateMultiSelect('instruments')"><label for="i_ElectricGuitar">Electric Guitar ÈõªÂêâ‰ªñ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_ClassicalGuitar" value="Classical Guitar" onchange="updateMultiSelect('instruments')"><label for="i_ClassicalGuitar">Classical Guitar Âè§ÂÖ∏Âêâ‰ªñ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Ukulele" value="Ukulele" onchange="updateMultiSelect('instruments')"><label for="i_Ukulele">Ukulele ÁÉèÂÖãÈ∫óÈ∫ó</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Banjo" value="Banjo" onchange="updateMultiSelect('instruments')"><label for="i_Banjo">Banjo Áè≠È≥©Áê¥</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üéª Âº¶Ê®Ç</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Violin" value="Violin" onchange="updateMultiSelect('instruments')"><label for="i_Violin">Violin Â∞èÊèêÁê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Cello" value="Cello" onchange="updateMultiSelect('instruments')"><label for="i_Cello">Cello Â§ßÊèêÁê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Strings" value="String Orchestra" onchange="updateMultiSelect('instruments')"><label for="i_Strings">String Orchestra Âº¶Ê®ÇÂúò</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Harp" value="Harp" onchange="updateMultiSelect('instruments')"><label for="i_Harp">Harp Ë±éÁê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Erhu" value="Erhu" onchange="updateMultiSelect('instruments')"><label for="i_Erhu">Erhu ‰∫åËÉ°</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Guzheng" value="Guzheng" onchange="updateMultiSelect('instruments')"><label for="i_Guzheng">Guzheng Âè§ÁÆè</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Pipa" value="Pipa" onchange="updateMultiSelect('instruments')"><label for="i_Pipa">Pipa ÁêµÁê∂</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé∏ Ë≤ùÊñØ</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Bass" value="Bass Guitar" onchange="updateMultiSelect('instruments')"><label for="i_Bass">Bass Guitar ÈõªË≤ùÊñØ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_SynthBass" value="Synth Bass" onchange="updateMultiSelect('instruments')"><label for="i_SynthBass">Synth Bass ÂêàÊàêË≤ùÊñØ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_808" value="808 Bass" onchange="updateMultiSelect('instruments')"><label for="i_808">808 Bass</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Upright" value="Upright Bass" onchange="updateMultiSelect('instruments')"><label for="i_Upright">Upright Bass ‰ΩéÈü≥ÊèêÁê¥</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">ü•Å ÊâìÊìä</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Drums" value="Drums" onchange="updateMultiSelect('instruments')"><label for="i_Drums">Drums ÁàµÂ£´Èºì</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_ElectronicDrums" value="Electronic Drums" onchange="updateMultiSelect('instruments')"><label for="i_ElectronicDrums">Electronic Drums ÈõªÂ≠êÈºì</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Percussion" value="Percussion" onchange="updateMultiSelect('instruments')"><label for="i_Percussion">Percussion ÊâìÊìäÊ®Ç</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Congas" value="Congas" onchange="updateMultiSelect('instruments')"><label for="i_Congas">Congas Â∫∑Âä†Èºì</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Timpani" value="Timpani" onchange="updateMultiSelect('instruments')"><label for="i_Timpani">Timpani ÂÆöÈü≥Èºì</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Taiko" value="Taiko" onchange="updateMultiSelect('instruments')"><label for="i_Taiko">Taiko Â§™Èºì</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé∑ ÁÆ°Ê®Ç</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Saxophone" value="Saxophone" onchange="updateMultiSelect('instruments')"><label for="i_Saxophone">Saxophone Ëñ©ÂÖãÊñØÈ¢®</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Trumpet" value="Trumpet" onchange="updateMultiSelect('instruments')"><label for="i_Trumpet">Trumpet Â∞èËôü</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Trombone" value="Trombone" onchange="updateMultiSelect('instruments')"><label for="i_Trombone">Trombone Èï∑Ëôü</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Flute" value="Flute" onchange="updateMultiSelect('instruments')"><label for="i_Flute">Flute Èï∑Á¨õ</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Clarinet" value="Clarinet" onchange="updateMultiSelect('instruments')"><label for="i_Clarinet">Clarinet ÂñÆÁ∞ßÁÆ°</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Harmonica" value="Harmonica" onchange="updateMultiSelect('instruments')"><label for="i_Harmonica">Harmonica Âè£Áê¥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Bagpipes" value="Bagpipes" onchange="updateMultiSelect('instruments')"><label for="i_Bagpipes">Bagpipes È¢®Á¨õ</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üéõÔ∏è ÈõªÂ≠ê/Áèæ‰ª£</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Pads" value="Synth Pads" onchange="updateMultiSelect('instruments')"><label for="i_Pads">Synth Pads ÂêàÊàêÂ¢äÈü≥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Arpeggio" value="Arpeggio" onchange="updateMultiSelect('instruments')"><label for="i_Arpeggio">Arpeggio Áê∂Èü≥</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Lead" value="Lead Synth" onchange="updateMultiSelect('instruments')"><label for="i_Lead">Lead Synth ‰∏ªÂ•èÂêàÊàê</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_DrumMachine" value="Drum Machine" onchange="updateMultiSelect('instruments')"><label for="i_DrumMachine">Drum Machine ÈºìÊ©ü</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Sampler" value="Sampler" onchange="updateMultiSelect('instruments')"><label for="i_Sampler">Sampler ÂèñÊ®£Ê©ü</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_FX" value="Sound Effects" onchange="updateMultiSelect('instruments')"><label for="i_FX">Sound Effects Èü≥Êïà</label></div>
                                </div>
                                <div class="dropdown-group">
                                    <div class="dropdown-group-label">üé§ ‰∫∫ËÅ≤ÂÖÉÁ¥†</div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_BackingVocals" value="Backing Vocals" onchange="updateMultiSelect('instruments')"><label for="i_BackingVocals">Backing Vocals ÂíåËÅ≤</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_Choir" value="Choir" onchange="updateMultiSelect('instruments')"><label for="i_Choir">Choir ÂêàÂî±Âúò</label></div>
                                    <div class="dropdown-option"><input type="checkbox" id="i_VocalChops" value="Vocal Chops" onchange="updateMultiSelect('instruments')"><label for="i_VocalChops">Vocal Chops ‰∫∫ËÅ≤ÂàáÁâá</label></div>
                                </div>
                                <div class="dropdown-actions">
                                    <button type="button" onclick="clearAll('instruments')">Ê∏ÖÈô§ÂÖ®ÈÉ®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ëº∏Âá∫Ë®≠ÂÆö -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">üì§</div>
                <h2 class="card-title">Ëº∏Âá∫Ë®≠ÂÆö</h2>
            </div>

            <div class="form-row-3">
                <div class="form-group">
                    <label class="form-label">‚è±Ô∏è Ê≠åÊõ≤ÊôÇÈï∑</label>
                    <select id="duration">
                        <option value="Short, 2 minutes">Áü≠Áâà 2ÂàÜÈêò</option>
                        <option value="Standard, 3 minutes" selected>Ê®ôÊ∫ñ 3ÂàÜÈêò</option>
                        <option value="Extended, 4-5 minutes">Âä†Èï∑ 4-5ÂàÜÈêò</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">üî¢ ÁîüÊàêÁâàÊú¨Êï∏</label>
                    <select id="count">
                        <option value="1">1 ÂÄãÁâàÊú¨</option>
                        <option value="2">2 ÂÄãÁâàÊú¨</option>
                        <option value="3">3 ÂÄãÁâàÊú¨</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">üéØ ÂâµÊÑèÁ®ãÂ∫¶</label>
                    <select id="creativity">
                        <option value="0.7">‰øùÂÆà (Á©©ÂÆö)</option>
                        <option value="0.85" selected>Âπ≥Ë°°</option>
                        <option value="0.95">Â§ßËÜΩ (ÂâµÊÑè)</option>
                        <option value="1.0">ÂØ¶È©óÊÄß</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">üìù È°çÂ§ñË¶ÅÊ±Ç <span class="label-hint">ÔºàÈÅ∏Â°´Ôºâ</span></label>
                <textarea id="requirements" placeholder="‰æãÂ¶ÇÔºöÂä†ÂÖ•ËΩâÈü≥ÊäÄÂ∑ß„ÄÅÁâπÂÆöÊäºÈüªÊñπÂºè„ÄÅÊüêÁ®ÆÊÉÖÂ¢ÉÊèèÂØ´..."></textarea>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="randomFill()">üé≤ Èö®Ê©üÈùàÊÑü</button>
                <button class="btn btn-primary" id="generateBtn" onclick="generateLyrics()">‚ú® ÈñãÂßãÁîüÊàê</button>
            </div>
        </div>

        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p class="loading-text">AI Ê≠£Âú®ÁÇ∫‰Ω†Ââµ‰Ωú‰∏≠...</p>
        </div>

        <!-- ÁµêÊûúÂçÄÂüü -->
        <div class="result-section" id="resultSection">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üé∂</div>
                    <h2 class="card-title">ÁîüÊàêÁµêÊûú</h2>
                </div>
                <div class="version-tabs" id="versionTabs"></div>
                <div id="versionsContainer"></div>
            </div>
        </div>

        <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importLyrics(event)">

        <!-- Ë©ûÂ∫´ÂçÄÂüü -->
        <div class="library-section">
            <div class="library-header">
                <h2 class="library-title">üìö ÊàëÁöÑË©ûÂ∫´ <span class="library-count" id="libCount">0</span></h2>
                <div class="global-actions">
                    <button class="import-btn" onclick="document.getElementById('importFile').click()">üì• ÂåØÂÖ•</button>
                    <button class="export-btn" onclick="exportLibrary()">üì§ ÂåØÂá∫</button>
                </div>
            </div>
            <div id="libraryList" class="library-list"></div>
        </div>

        <input type="file" id="importLibraryFile" accept=".json" style="display: none;" onchange="importLibrary(event)">

        <div class="tips-card">
            <div class="tips-header">üí° ‰ΩøÁî®ÊèêÁ§∫</div>
            <ul class="tips-list">
                <li>ÈªûÊìä„ÄåÈÄ≤ÈöéÈü≥Ê®ÇË®≠ÂÆö„ÄçÂ±ïÈñãÊõ¥Â§öÂ∞àÊ•≠ÂèÉÊï∏</li>
                <li>ÊØèÂÄãÁâàÊú¨ÈÉΩÊúâÁç®Á´ãÁöÑÈ¢®Ê†ºÊèêÁ§∫Ë©ûÔºåÈÅ©Âêà‰∏çÂêåÂòóË©¶</li>
                <li>Á¥îÈü≥Ê®ÇÊ®°ÂºèÊúÉÁîüÊàêÈü≥Ê®ÇÁµêÊßãÊèèËø∞ÔºåÈÅ©ÂêàÈÖçÊ®ÇË£Ω‰Ωú</li>
                <li>ÂâµÊÑèÁ®ãÂ∫¶Ë∂äÈ´òÔºåÁîüÊàêÁµêÊûúË∂äÊúâÈ©öÂñú‰ΩÜ‰πüÂèØËÉΩ‰∏çÁ©©ÂÆö</li>
                <li>ÊâÄÊúâË®≠ÂÆöÊúÉËá™ÂãïÂÑ≤Â≠òÔºåÈáçÊñ∞Êï¥ÁêÜ‰∏çÊúÉÈÅ∫Â§±</li>
            </ul>
        </div>

        <footer class="footer">
            <p>Powered by Google Gemini AI ¬∑ Made with ‚ù§Ô∏è</p>
        </footer>
    </div>

    <button class="settings-btn" onclick="openApiModal()" title="API Ë®≠ÂÆö">‚öôÔ∏è</button>

    <!-- API Modal -->
    <div id="apiModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîë API ÈáëÈë∞Ë®≠ÂÆö</h2>
                <p>Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑ Google Gemini API ÈáëÈë∞</p>
            </div>
            <div class="info-box">
                <p><strong>Â¶Ç‰ΩïÂèñÂæóÔºü</strong></p>
                <p>1. ÂâçÂæÄ <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a></p>
                <p>2. ÁôªÂÖ•‰∏¶Âª∫Á´ã API Key</p>
            </div>
            <div class="modal-body">
                <input type="password" id="apiKeyInput" placeholder="AIza..." autocomplete="off">
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeApiModal()">ÂèñÊ∂à</button>
                <button class="modal-btn modal-btn-primary" onclick="saveApiKey()">ÂÑ≤Â≠ò</button>
            </div>
        </div>
    </div>

    <script>
        // ===== ÂÖ®ÂüüËÆäÊï∏ =====
        let db = null;
        const DB_NAME = 'LyricsGeneratorProDB';
        const STORE_NAME = 'formState';
        const API_KEY_STORE = 'apiKeyStore';
        let generatedVersions = [];

        // ===== IndexedDB =====
        async function initIndexedDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, 1);
                request.onerror = () => reject(request.error);
                request.onsuccess = () => { db = request.result; resolve(db); };
                request.onupgradeneeded = (event) => {
                    const database = event.target.result;
                    if (!database.objectStoreNames.contains(STORE_NAME)) database.createObjectStore(STORE_NAME);
                    if (!database.objectStoreNames.contains(API_KEY_STORE)) database.createObjectStore(API_KEY_STORE);
                };
            });
        }

        function saveToIndexedDB(storeName, key, data) {
            return new Promise((resolve, reject) => {
                if (!db) return reject(new Error('DB not ready'));
                const tx = db.transaction(storeName, 'readwrite');
                tx.objectStore(storeName).put(data, key).onsuccess = () => resolve();
            });
        }

        function loadFromIndexedDB(storeName, key) {
            return new Promise((resolve, reject) => {
                if (!db) return reject(new Error('DB not ready'));
                const tx = db.transaction(storeName, 'readonly');
                const request = tx.objectStore(storeName).get(key);
                request.onsuccess = () => resolve(request.result);
            });
        }

        // ===== ÊäòÁñäÂçÄÂ°ä =====
        function toggleSection(id) {
            const section = document.getElementById(`${id}Section`);
            const toggle = section.previousElementSibling;
            const arrow = document.getElementById(`${id}ArrowIcon`);
            
            section.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        // ===== Ê≠åÊõ≤È°ûÂûãÂàáÊèõ =====
        document.querySelectorAll('input[name="songType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const vocalSection = document.getElementById('vocalSection');
                const vocalToggle = vocalSection.previousElementSibling;
                if (this.value === 'instrumental') {
                    vocalToggle.style.opacity = '0.5';
                    vocalToggle.style.pointerEvents = 'none';
                } else {
                    vocalToggle.style.opacity = '1';
                    vocalToggle.style.pointerEvents = 'auto';
                }
                saveFormState();
            });
        });

        // ===== Â§öÈÅ∏‰∏ãÊãâÂºè =====
        function toggleDropdown(type) {
            const dropdown = document.getElementById(`${type}Dropdown`);
            const arrow = document.getElementById(`${type}Arrow`);
            const display = dropdown.previousElementSibling;
            const isOpen = dropdown.classList.contains('show');
            
            document.querySelectorAll('.multi-select-dropdown').forEach(d => d.classList.remove('show'));
            document.querySelectorAll('.multi-select-arrow').forEach(a => a.classList.remove('open'));
            document.querySelectorAll('.multi-select-display').forEach(d => d.classList.remove('active'));
            
            if (!isOpen) {
                dropdown.classList.add('show');
                arrow.classList.add('open');
                display.classList.add('active');
            }
        }

        function updateMultiSelect(type) {
            const container = document.getElementById(`${type}Container`);
            const selectedDiv = document.getElementById(`${type}Selected`);
            const countSpan = document.getElementById(`${type}Count`);
            
            const checkboxes = container.querySelectorAll('input[type="checkbox"]');
            const selectedValues = [];
            
            checkboxes.forEach(cb => {
                if (cb.checked) selectedValues.push(cb.value);
                cb.closest('.dropdown-option')?.classList.toggle('selected', cb.checked);
            });
            
            if (selectedValues.length === 0) {
                selectedDiv.innerHTML = `<span class="multi-select-placeholder">ÈªûÊìäÈÅ∏Êìá...</span>`;
                if (countSpan) countSpan.textContent = '';
            } else {
                selectedDiv.innerHTML = selectedValues.map(v => 
                    `<span class="selected-tag">${v}<span class="remove-tag" onclick="event.stopPropagation(); removeSelection('${type}', '${v}')">√ó</span></span>`
                ).join('');
                if (countSpan) countSpan.textContent = `Â∑≤ÈÅ∏ ${selectedValues.length}`;
            }
            saveFormState();
        }

        function removeSelection(type, value) {
            const container = document.getElementById(`${type}Container`);
            const checkbox = container.querySelector(`input[value="${value}"]`);
            if (checkbox) {
                checkbox.checked = false;
                updateMultiSelect(type);
            }
        }

        function clearAll(type) {
            const container = document.getElementById(`${type}Container`);
            container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateMultiSelect(type);
        }

        function getSelectedValues(type) {
            const container = document.getElementById(`${type}Container`);
            const values = [];
            container.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => values.push(cb.value));
            return values;
        }

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.multi-select-container')) {
                document.querySelectorAll('.multi-select-dropdown').forEach(d => d.classList.remove('show'));
                document.querySelectorAll('.multi-select-arrow').forEach(a => a.classList.remove('open'));
                document.querySelectorAll('.multi-select-display').forEach(d => d.classList.remove('active'));
            }
        });

        // ===== Ë°®ÂñÆÁãÄÊÖã =====
        function saveFormState() {
            const state = {
                theme: document.getElementById('theme').value,
                songType: document.querySelector('input[name="songType"]:checked')?.value || 'vocal',
                genre: getSelectedValues('genre'),
                mood: getSelectedValues('mood'),
                instruments: getSelectedValues('instruments'),
                bpm: document.getElementById('bpm').value,
                era: document.getElementById('era').value,
                key: document.getElementById('key').value,
                region: document.getElementById('region').value,
                production: document.getElementById('production').value,
                structure: document.getElementById('structure').value,
                technique: document.getElementById('technique').value,
                voice: document.getElementById('voice').value,
                language: document.getElementById('language').value,
                vocalEffect: document.getElementById('vocalEffect').value,
                lyricStyle: document.getElementById('lyricStyle').value,
                duration: document.getElementById('duration').value,
                count: document.getElementById('count').value,
                creativity: document.getElementById('creativity').value,
                requirements: document.getElementById('requirements').value
            };
            saveToIndexedDB(STORE_NAME, 'formState', state).catch(console.error);
        }

        async function loadFormState() {
            try {
                const state = await loadFromIndexedDB(STORE_NAME, 'formState');
                if (!state) return;
                
                document.getElementById('theme').value = state.theme || '';
                
                if (state.songType) {
                    const radio = document.querySelector(`input[name="songType"][value="${state.songType}"]`);
                    if (radio) { radio.checked = true; radio.dispatchEvent(new Event('change')); }
                }
                
                ['genre', 'mood', 'instruments'].forEach(type => {
                    if (Array.isArray(state[type])) {
                        const container = document.getElementById(`${type}Container`);
                        state[type].forEach(v => {
                            const cb = container.querySelector(`input[value="${v}"]`);
                            if (cb) cb.checked = true;
                        });
                        updateMultiSelect(type);
                    }
                });
                
                ['bpm', 'era', 'key', 'region', 'production', 'structure', 'technique', 'voice', 'language', 'vocalEffect', 'lyricStyle', 'duration', 'count', 'creativity'].forEach(id => {
                    if (state[id]) document.getElementById(id).value = state[id];
                });
                
                document.getElementById('requirements').value = state.requirements || '';
            } catch (e) { console.error('Load state error:', e); }
        }

        // Áõ£ËÅΩË°®ÂñÆËÆäÂåñ
        document.querySelectorAll('input, select, textarea').forEach(el => {
            el.addEventListener('change', saveFormState);
            el.addEventListener('input', saveFormState);
        });

        // ===== API ÁÆ°ÁêÜ =====
        function openApiModal() {
            document.getElementById('apiModal').classList.add('show');
            loadFromIndexedDB(API_KEY_STORE, 'apiKey').then(key => {
                if (key) document.getElementById('apiKeyInput').value = key;
            }).catch(() => {});
        }

        function closeApiModal() {
            document.getElementById('apiModal').classList.remove('show');
        }

        async function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if (!key) { alert('Ë´ãËº∏ÂÖ• API ÈáëÈë∞'); return; }
            await saveToIndexedDB(API_KEY_STORE, 'apiKey', key);
            alert('‚úÖ Â∑≤ÂÑ≤Â≠òÔºÅ');
            closeApiModal();
        }

        async function getApiKey() {
            try { return await loadFromIndexedDB(API_KEY_STORE, 'apiKey'); }
            catch { return null; }
        }

        // ===== È¢®Ê†ºÊèêÁ§∫Ë©ûÁîüÊàê =====
        function shuffleArray(arr) {
            const newArr = [...arr];
            for (let i = newArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
            }
            return newArr;
        }

        function generateUniqueStylePrompts(count, settings) {
            const prompts = [];
            
            for (let i = 0; i < count; i++) {
                const parts = [];
                
                // È¢®Ê†º (Èö®Ê©üÈÅ∏Âèñ)
                if (settings.genre.length > 0) {
                    const shuffled = shuffleArray(settings.genre);
                    parts.push(shuffled.slice(0, Math.min(2, shuffled.length)).join(', '));
                }
                
                // ÊÉÖÊÑü (Èö®Ê©üÈÅ∏Âèñ)
                if (settings.mood.length > 0) {
                    const shuffled = shuffleArray(settings.mood);
                    parts.push(shuffled.slice(0, Math.min(2, shuffled.length)).join(', '));
                }
                
                // Ê®ÇÂô® (Èö®Ê©üÈÅ∏Âèñ)
                if (settings.instruments.length > 0) {
                    const shuffled = shuffleArray(settings.instruments);
                    parts.push(shuffled.slice(0, Math.min(3, shuffled.length)).join(', '));
                }
                
                // ÂÖ∂‰ªñË®≠ÂÆö
                if (settings.bpm) parts.push(settings.bpm);
                if (settings.era) parts.push(settings.era);
                if (settings.key) parts.push(settings.key);
                if (settings.region) parts.push(settings.region);
                if (settings.production) parts.push(settings.production);
                if (settings.vocalEffect && !settings.isInstrumental) parts.push(settings.vocalEffect);
                
                // ‰∫∫ËÅ≤/Á¥îÈü≥Ê®Ç
                if (settings.isInstrumental) {
                    parts.push('Instrumental');
                } else {
                    parts.push(settings.voice);
                }
                
                // Èö®Ê©ü‰øÆÈ£æË©û
                const modifiers = ['Emotional', 'Melodic', 'Groovy', 'Atmospheric', 'Powerful', 'Soft', 'Energetic', 'Cinematic', 'Catchy', 'Anthemic'];
                if (Math.random() > 0.4) {
                    parts.push(modifiers[Math.floor(Math.random() * modifiers.length)]);
                }
                
                prompts.push(shuffleArray(parts).join(', '));
            }
            
            return prompts;
        }

        // ===== Ê≠åË©ûÁîüÊàê =====
        async function generateLyrics() {
            const theme = document.getElementById('theme').value.trim();
            if (!theme) { alert('Ë´ãËº∏ÂÖ•Ê≠åÊõ≤‰∏ªÈ°å'); return; }

            const apiKey = await getApiKey();
            if (!apiKey) { alert('Ë´ãÂÖàË®≠ÂÆö API ÈáëÈë∞'); openApiModal(); return; }

            const isInstrumental = document.querySelector('input[name="songType"]:checked').value === 'instrumental';
            const count = parseInt(document.getElementById('count').value);
            const creativity = parseFloat(document.getElementById('creativity').value);
            
            const settings = {
                theme,
                isInstrumental,
                genre: getSelectedValues('genre'),
                mood: getSelectedValues('mood'),
                instruments: getSelectedValues('instruments'),
                bpm: document.getElementById('bpm').value,
                era: document.getElementById('era').value,
                key: document.getElementById('key').value,
                region: document.getElementById('region').value,
                production: document.getElementById('production').value,
                structure: document.getElementById('structure').value,
                technique: document.getElementById('technique').value,
                voice: document.getElementById('voice').value,
                language: document.getElementById('language').value,
                vocalEffect: document.getElementById('vocalEffect').value,
                lyricStyle: document.getElementById('lyricStyle').value,
                duration: document.getElementById('duration').value,
                requirements: document.getElementById('requirements').value
            };

            document.getElementById('generateBtn').disabled = true;
            document.getElementById('loading').classList.add('show');
            document.getElementById('resultSection').classList.remove('show');

            const stylePrompts = generateUniqueStylePrompts(count, settings);

            // Âª∫ÊßãÊèêÁ§∫Ë©û
            let prompt;
            if (isInstrumental) {
                prompt = `‰Ω†ÊòØÂ∞àÊ•≠Èü≥Ê®ÇË£Ω‰Ωú‰∫∫ÔºåË´ãÊ†πÊìö‰ª•‰∏ãË®≠ÂÆöÂâµ‰ΩúÁ¥îÈü≥Ê®ÇÁµêÊßãÔºö

„ÄêË®≠ÂÆö„Äë
- ‰∏ªÈ°å/Ê∞õÂúçÔºö${theme}
- È¢®Ê†ºÔºö${settings.genre.join(', ') || 'Ëá™Âãï'}
- ÊÉÖÊÑüÔºö${settings.mood.join(', ') || 'Ëá™Âãï'}
- Ê®ÇÂô®Ôºö${settings.instruments.join(', ') || 'Ëá™Âãï'}
- ÁØÄÂ•èÔºö${settings.bpm || 'Ëá™Âãï'}
- Âπ¥‰ª£Ôºö${settings.era || 'Ëá™Âãï'}
- Ë™øÊÄßÔºö${settings.key || 'Ëá™Âãï'}
- Âú∞ÂüüÔºö${settings.region || 'Ëá™Âãï'}
- Ë≥™ÊÑüÔºö${settings.production || 'Ëá™Âãï'}
- ÁµêÊßãÔºö${settings.structure || 'Ê®ôÊ∫ñ'}
- ÁâπÊÆäÊäÄÊ≥ïÔºö${settings.technique || 'ÁÑ°'}
- ÊôÇÈï∑Ôºö${settings.duration}
${settings.requirements ? `- È°çÂ§ñË¶ÅÊ±ÇÔºö${settings.requirements}` : ''}

„ÄêËº∏Âá∫Ê†ºÂºè„Äë‰ΩøÁî® Suno Ê®ôÁ±§Â¶Ç [Intro], [Main Theme], [Build Up], [Drop], [Breakdown], [Bridge], [Outro]
Âú®ÊØèÂÄãÊÆµËêΩÂæåÁî®Êã¨ËôüÊèèËø∞Ë©≤ÊÆµÈü≥Ê®ÇÁâπÈªû„ÄÇ

Ë´ãÁîüÊàê ${count} ÂÄã‰∏çÂêåÁâàÊú¨ÔºåÁî® "=== ÁâàÊú¨ X ===" ÂàÜÈöî„ÄÇ`;
            } else {
                prompt = `‰Ω†ÊòØÂ∞àÊ•≠Ê≠åË©ûÂâµ‰ΩúËÄÖÔºåË´ãÊ†πÊìö‰ª•‰∏ãË®≠ÂÆöÂâµ‰ΩúÊ≠åË©ûÔºö

„ÄêË®≠ÂÆö„Äë
- ‰∏ªÈ°åÔºö${theme}
- È¢®Ê†ºÔºö${settings.genre.join(', ') || 'Ëá™Âãï'}
- ÊÉÖÊÑüÔºö${settings.mood.join(', ') || 'Ëá™Âãï'}
- Ê®ÇÂô®Ôºö${settings.instruments.join(', ') || 'Ëá™Âãï'}
- ÁØÄÂ•èÔºö${settings.bpm || 'Ëá™Âãï'}
- Âπ¥‰ª£Ôºö${settings.era || 'Ëá™Âãï'}
- Ë™øÊÄßÔºö${settings.key || 'Ëá™Âãï'}
- Âú∞ÂüüÔºö${settings.region || 'Ëá™Âãï'}
- Ë≥™ÊÑüÔºö${settings.production || 'Ëá™Âãï'}
- ÁµêÊßãÔºö${settings.structure || 'Ê®ôÊ∫ñ'}
- ÁâπÊÆäÊäÄÊ≥ïÔºö${settings.technique || 'ÁÑ°'}
- ÊºîÂî±Ôºö${settings.voice}
- Ë™ûË®ÄÔºö${settings.language}
- ‰∫∫ËÅ≤ÊïàÊûúÔºö${settings.vocalEffect || 'Ëá™ÁÑ∂'}
- Ê≠åË©ûÈ¢®Ê†ºÔºö${settings.lyricStyle || 'Ëá™Âãï'}
- ÊôÇÈï∑Ôºö${settings.duration}
${settings.requirements ? `- È°çÂ§ñË¶ÅÊ±ÇÔºö${settings.requirements}` : ''}

„ÄêËº∏Âá∫Ê†ºÂºè„Äë‰ΩøÁî® Suno Ê®ôÁ±§Ôºö[Intro], [Verse 1], [Pre-Chorus], [Chorus], [Verse 2], [Bridge], [Outro] Á≠â

Ë´ãÁîüÊàê ${count} ÂÄã‰∏çÂêåÁâàÊú¨ÔºåÊØèÂÄãÁâàÊú¨È¢®Ê†ºÂíåÂÖßÂÆπË¶ÅÊúâÂ∑ÆÁï∞ÔºåÁî® "=== ÁâàÊú¨ X ===" ÂàÜÈöî„ÄÇ`;
            }

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: {
                            temperature: creativity,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 8192,
                        }
                    })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);

                const fullText = data.candidates[0].content.parts[0].text;
                
                let versions = [];
                if (count > 1) {
                    const parts = fullText.split(/===\s*ÁâàÊú¨\s*\d+\s*===/);
                    versions = parts.filter(p => p.trim()).map((text, idx) => ({
                        lyrics: text.trim(),
                        stylePrompt: stylePrompts[idx] || stylePrompts[0]
                    }));
                } else {
                    versions = [{ lyrics: fullText.trim(), stylePrompt: stylePrompts[0] }];
                }
                
                generatedVersions = versions;
                renderVersions(versions);
                
                document.getElementById('resultSection').classList.add('show');
                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                alert('ÁîüÊàêÂ§±ÊïóÔºö' + error.message);
            } finally {
                document.getElementById('generateBtn').disabled = false;
                document.getElementById('loading').classList.remove('show');
            }
        }

        // ===== Ê∏≤ÊüìÁµêÊûú =====
        function renderVersions(versions) {
            document.getElementById('versionTabs').innerHTML = versions.map((_, i) => 
                `<button class="version-tab ${i === 0 ? 'active' : ''}" onclick="switchVersion(${i})">üéµ ÁâàÊú¨ ${i + 1}</button>`
            ).join('');
            
            document.getElementById('versionsContainer').innerHTML = versions.map((v, i) => `
                <div class="version-content ${i === 0 ? 'active' : ''}" id="version-${i}">
                    <div class="style-prompt-section">
                        <div class="style-prompt-header">üé® Suno È¢®Ê†ºÊèêÁ§∫Ë©û</div>
                        <div class="style-prompt-output">${v.stylePrompt}</div>
                        <button class="copy-style-prompt-btn" onclick="copyText('${encodeURIComponent(v.stylePrompt)}', this)">üìã Ë§áË£ΩÊèêÁ§∫Ë©û</button>
                    </div>
                    <pre class="lyrics-output">${escapeHtml(v.lyrics)}</pre>
                    <div class="action-buttons">
                        <button class="action-btn copy-btn" onclick="copyLyrics(${i})">üìã Ë§áË£Ω</button>
                        <button class="action-btn suno-btn" onclick="window.open('https://suno.com/create','_blank')">üöÄ Suno</button>
                        <button class="action-btn export-btn" onclick="exportVersion(${i})">üíæ ÂåØÂá∫</button>
                        <button class="action-btn add-lib-btn" onclick="addToLibrary(${i})">üìö Êî∂Ëóè</button>
                    </div>
                </div>
            `).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function switchVersion(idx) {
            document.querySelectorAll('.version-tab').forEach((t, i) => t.classList.toggle('active', i === idx));
            document.querySelectorAll('.version-content').forEach((c, i) => c.classList.toggle('active', i === idx));
        }

        // ===== Ë§áË£Ω/ÂåØÂá∫ÂäüËÉΩ =====
        function copyText(encoded, btn) {
            navigator.clipboard.writeText(decodeURIComponent(encoded)).then(() => {
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Ë§áË£ΩÔºÅ';
                setTimeout(() => btn.textContent = orig, 2000);
            });
        }

        function copyLyrics(idx) {
            const lyrics = generatedVersions[idx]?.lyrics || '';
            
            // üî• ‰øÆÊîπÈÄôË£°ÔºöÂú®ÈÄ≤ÂÖ• Promise ‰πãÂâçÔºåÂÖàÂ∞á event.target Â≠òÂÖ•ËÆäÊï∏ btn
            const btn = event.target;

            navigator.clipboard.writeText(lyrics).then(() => {
                // ‚ùå ÁßªÈô§ÈÄôË°åÔºö const btn = event.target; 
                
                // Áõ¥Êé•‰ΩøÁî®‰∏äÈù¢Â≠òÂ•ΩÁöÑ btn
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Ë§áË£ΩÔºÅ';
                setTimeout(() => btn.textContent = orig, 2000);
            });
        }

        function exportVersion(idx) {
            const v = generatedVersions[idx];
            if (!v) return;
            const data = {
                theme: document.getElementById('theme').value,
                lyrics: v.lyrics.split('\n'),
                stylePrompt: v.stylePrompt,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `lyrics_v${idx + 1}_${Date.now()}.json`;
            link.click();
        }

        function importLyrics(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.theme) document.getElementById('theme').value = data.theme;
                    let lyrics = data.lyrics;
                    if (Array.isArray(lyrics)) lyrics = lyrics.join('\n');
                    generatedVersions = [{ lyrics, stylePrompt: data.stylePrompt || '' }];
                    renderVersions(generatedVersions);
                    document.getElementById('resultSection').classList.add('show');
                    alert('‚úÖ ÂåØÂÖ•ÊàêÂäüÔºÅ');
                } catch { alert('ÂåØÂÖ•Â§±Êïó'); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ===== Èö®Ê©üÈùàÊÑü =====
        function randomFill() {
            const themes = ['Â§±ÊàÄÁöÑÊ∑±Â§ú', 'ËøΩÂ§¢ÊóÖÁ®ã', 'Â§èÊó•Êµ∑ÈÇä', 'ÂüéÂ∏ÇÈúìËôπ', 'ÊòüÁ©∫ÂëäÁôΩ', 'Èõ®Â§©ÊÄùÂøµ', 'ÂçàÂ§úÁãÇÊ≠°', 'ÈÅ†ÊñπÊïÖÈÑâ', 'ÈáçÊñ∞ÈñãÂßã', 'ÁÑ°Áõ°Á≠âÂæÖ', 'ÈùíÊò•Ë®òÊÜ∂', 'ÂøÉÁ¢é‰πãÂæå', 'ÂãáÊï¢ÂâçË°å', 'Êµ™Êº´ÈÇÇÈÄÖ', 'Â≠§Áç®ÊóÖ‰∫∫'];
            document.getElementById('theme').value = themes[Math.floor(Math.random() * themes.length)];
            
            // Èö®Ê©üÈÅ∏ÊìáÂêÑÈ†Ö
            ['genre', 'mood', 'instruments'].forEach(type => {
                clearAll(type);
                const container = document.getElementById(`${type}Container`);
                const allCbs = Array.from(container.querySelectorAll('input[type="checkbox"]'));
                const shuffled = shuffleArray(allCbs);
                const count = type === 'instruments' ? Math.floor(Math.random() * 4) + 1 : Math.floor(Math.random() * 2) + 1;
                shuffled.slice(0, count).forEach(cb => cb.checked = true);
                updateMultiSelect(type);
            });
            
            // Èö®Ê©üÂÖ∂‰ªñË®≠ÂÆö
            const randomSelect = (id) => {
                const sel = document.getElementById(id);
                const opts = sel.options;
                sel.selectedIndex = Math.floor(Math.random() * opts.length);
            };
            
            ['bpm', 'era', 'key', 'region', 'production', 'vocalEffect'].forEach(randomSelect);
            
            saveFormState();
        }

        // ===== Ë©ûÂ∫´ÁÆ°ÁêÜ =====
        let savedSongs = JSON.parse(localStorage.getItem('lyrics_library_pro')) || [];

        function addToLibrary(idx) {
            const v = generatedVersions[idx];
            if (!v || !v.lyrics.trim()) return alert('Ê≤íÊúâÂÖßÂÆπÂèØÊî∂ËóèÔºÅ');
            
            savedSongs.unshift({
                id: Date.now(),
                theme: document.getElementById('theme').value || 'Êú™ÂëΩÂêç',
                date: new Date().toLocaleString(),
                lyrics: v.lyrics,
                stylePrompt: v.stylePrompt
            });

            try {
                localStorage.setItem('lyrics_library_pro', JSON.stringify(savedSongs));
                renderLibrary();
                const btn = event.target;
                const orig = btn.textContent;
                btn.textContent = '‚úÖ Â∑≤Êî∂Ëóè';
                setTimeout(() => btn.textContent = orig, 1500);
            } catch (e) {
                if (e.name === 'QuotaExceededError') {
                    alert('ÂÑ≤Â≠òÁ©∫ÈñìÂ∑≤ÊªøÔºåË´ãÂÖàÂåØÂá∫ÂÇô‰ªΩ');
                    savedSongs.shift();
                }
            }
        }

        function deleteFromLibrary(id) {
            if (!confirm('Á¢∫ÂÆöÂà™Èô§Ôºü')) return;
            savedSongs = savedSongs.filter(s => s.id !== id);
            localStorage.setItem('lyrics_library_pro', JSON.stringify(savedSongs));
            renderLibrary();
        }

        function loadFromLibrary(id) {
            const song = savedSongs.find(s => s.id === id);
            if (song) {
                document.getElementById('theme').value = song.theme;
                generatedVersions = [{ lyrics: song.lyrics, stylePrompt: song.stylePrompt || '' }];
                renderVersions(generatedVersions);
                document.getElementById('resultSection').classList.add('show');
                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function renderLibrary() {
            document.getElementById('libCount').textContent = savedSongs.length;
            const list = document.getElementById('libraryList');
            if (savedSongs.length === 0) {
                list.innerHTML = '<p style="text-align:center;color:var(--text-muted);padding:30px;">Ë©ûÂ∫´ÊòØÁ©∫ÁöÑ</p>';
                return;
            }
            list.innerHTML = savedSongs.map(s => `
                <div class="library-item">
                    <div class="lib-item-header">
                        <span>${s.theme}</span>
                        <span class="lib-item-date">${s.date}</span>
                    </div>
                    <div class="lib-preview">${s.lyrics.substring(0, 80)}...</div>
                    <div class="lib-actions">
                        <button class="btn-load" onclick="loadFromLibrary(${s.id})">‚úèÔ∏è ËºâÂÖ•</button>
                        <button class="btn-delete" onclick="deleteFromLibrary(${s.id})">üóëÔ∏è Âà™Èô§</button>
                    </div>
                </div>
            `).join('');
        }

        function exportLibrary() {
            if (savedSongs.length === 0) return alert('Ë©ûÂ∫´ÊòØÁ©∫ÁöÑ');
            const blob = new Blob([JSON.stringify(savedSongs, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `lyrics_library_${Date.now()}.json`;
            link.click();
        }

        function importLibrary(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (!Array.isArray(data)) throw new Error();
                    savedSongs = [...data, ...savedSongs];
                    localStorage.setItem('lyrics_library_pro', JSON.stringify(savedSongs));
                    renderLibrary();
                    alert(`ÊàêÂäüÂåØÂÖ• ${data.length} È¶ñÔºÅ`);
                } catch { alert('ÂåØÂÖ•Â§±Êïó'); }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ===== Enter ÈçµÊîØÊè¥ =====
        document.getElementById('theme').addEventListener('keypress', e => { if (e.key === 'Enter') generateLyrics(); });
        document.getElementById('apiKeyInput').addEventListener('keypress', e => { if (e.key === 'Enter') saveApiKey(); });

        // ===== ÂàùÂßãÂåñ =====
        async function init() {
            await initIndexedDB();
            await loadFormState();
            renderLibrary();
        }

        init();
    </script>
</body>
</html>
